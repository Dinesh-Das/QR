"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[766],{1210:(e,s,a)=>{a.d(s,{A:()=>l});var r=a(8168),t=a(5043);const i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 184H712v-64c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v64H384v-64c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v64H144c-17.7 0-32 14.3-32 32v664c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V216c0-17.7-14.3-32-32-32zm-40 656H184V460h656v380zM184 392V256h128v48c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-48h256v48c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-48h128v136H184z"}}]},name:"calendar",theme:"outlined"};var c=a(2172),n=function(e,s){return t.createElement(c.A,(0,r.A)({},e,{ref:s,icon:i}))};const l=t.forwardRef(n)},3285:(e,s,a)=>{a.r(s),a.d(s,{default:()=>S});var r=a(6237),t=a(119),i=a(9470),c=a(3889),n=a(3117),l=a(617),o=a(2261),u=a(5206),h=a(9073),d=a(1645),A=a(7419),y=a(6051),g=a(6612),f=a(8918),v=a(3927),x=a(5043),m=a(6649),p=a(8365),j=a(173),b=a(5423),k=a(2868),w=a(5123),T=a(579);const{Title:Q}=v.A,{TabPane:C}=f.A,S=()=>{const[e,s]=(0,x.useState)({totalQueries:0,openQueries:0,resolvedToday:0,overdueQueries:0,avgResolutionTime:0,highPriorityQueries:0}),{isTechUser:a,isAdmin:v}=(0,w.hm)();(0,x.useEffect)(()=>{const e=new AbortController;return S(e.signal),()=>{e.abort()}},[]);const S=async e=>{try{const[a,r,t,i,c]=await Promise.all([m.default.get("/queries/stats/count-open/TECH",{signal:e}).catch(()=>0),m.default.get("/queries/stats/resolved-today",{signal:e}).catch(()=>0),m.default.get("/queries/overdue",{signal:e}).then(e=>Array.isArray(e)?e.filter(e=>e.assignedTeam===k.r0.TECH).length:0).catch(()=>0),m.default.get("/queries/stats/avg-resolution-time/TECH",{signal:e}).catch(()=>0),m.default.get("/queries/high-priority",{signal:e}).then(e=>Array.isArray(e)?e.filter(e=>e.assignedTeam===k.r0.TECH).length:0).catch(()=>0)]);s({totalQueries:a+r,openQueries:a,resolvedToday:r,overdueQueries:t,avgResolutionTime:i,highPriorityQueries:c})}catch(a){console.error("Failed to load dashboard stats:",a)}};return(0,T.jsx)(b.PK,{children:(0,T.jsxs)("div",{style:{padding:24},children:[(0,T.jsx)(Q,{level:2,children:"Tech Dashboard"}),(0,T.jsxs)(A.A,{gutter:16,style:{marginBottom:16},children:[(0,T.jsx)(d.A,{span:6,children:(0,T.jsx)(h.A,{children:(0,T.jsx)(g.A,{title:"Open Queries",value:e.openQueries,prefix:(0,T.jsx)(n.A,{}),valueStyle:{color:"#cf1322"}})})}),(0,T.jsx)(d.A,{span:6,children:(0,T.jsx)(h.A,{children:(0,T.jsx)(g.A,{title:"Resolved Today",value:e.resolvedToday,prefix:(0,T.jsx)(r.A,{}),valueStyle:{color:"#3f8600"}})})}),(0,T.jsx)(d.A,{span:6,children:(0,T.jsx)(h.A,{children:(0,T.jsx)(g.A,{title:"Overdue",value:e.overdueQueries,prefix:(0,T.jsx)(i.A,{}),valueStyle:{color:e.overdueQueries>0?"#cf1322":"#3f8600"}})})}),(0,T.jsx)(d.A,{span:6,children:(0,T.jsx)(h.A,{children:(0,T.jsx)(g.A,{title:"Avg Resolution",value:e.avgResolutionTime,precision:1,suffix:"hrs",prefix:(0,T.jsx)(t.A,{})})})})]}),e.overdueQueries>0&&(0,T.jsx)(o.A,{message:`${e.overdueQueries} queries are overdue (>3 days)`,description:"These queries require immediate attention to maintain SLA compliance.",type:"error",showIcon:!0,style:{marginBottom:16},action:(0,T.jsx)(u.Ay,{size:"small",danger:!0,children:"View Overdue"})}),e.highPriorityQueries>0&&(0,T.jsx)(o.A,{message:`${e.highPriorityQueries} high priority queries pending`,description:"These queries have been marked as high priority and need urgent resolution.",type:"warning",showIcon:!0,style:{marginBottom:16},action:(0,T.jsx)(u.Ay,{size:"small",type:"primary",children:"View High Priority"})}),(0,T.jsxs)(f.A,{defaultActiveKey:"queries",size:"large",tabBarExtraContent:(0,T.jsx)(y.A,{children:(0,T.jsx)(u.Ay,{icon:(0,T.jsx)(l.A,{}),onClick:S,size:"small",children:"Refresh Stats"})}),children:[(0,T.jsx)(C,{tab:(0,T.jsxs)(y.A,{children:[(0,T.jsx)(n.A,{}),(0,T.jsx)("span",{children:"Query Inbox"}),e.openQueries>0&&(0,T.jsx)("span",{style:{background:"#ff4d4f",color:"white",borderRadius:"10px",padding:"2px 6px",fontSize:"12px"},children:e.openQueries})]}),children:(0,T.jsx)(j.A,{team:"TECH",userRole:"TECH_USER"})},"queries"),(0,T.jsx)(C,{tab:(0,T.jsxs)(y.A,{children:[(0,T.jsx)(c.A,{}),(0,T.jsx)("span",{children:"Query History"})]}),children:(0,T.jsx)(p.A,{})},"history")]})]})})}},5123:(e,s,a)=>{a.d(s,{hm:()=>c});var r=a(5043),t=a(3719),i=a(4642);const c=()=>{const[e,s]=(0,r.useState)(null),[a,c]=(0,r.useState)(!0),[n,l]=(0,r.useState)(null),o=(0,r.useCallback)(async()=>{if(!(0,t.wR)())return s(null),void c(!1);try{c(!0),l(null);const e=await i.A.getUserAccessSummary();s(e)}catch(e){console.warn("Failed to load access summary, using fallback:",e),l(e);const a=i.A.getFallbackAccessSummary();s(a)}finally{c(!1)}},[]);(0,r.useEffect)(()=>{o()},[o]);const u=(0,r.useCallback)(async e=>{try{return await i.A.hasScreenAccess(e)}catch(n){return console.warn("Screen access check failed, using fallback:",n),i.A.getFallbackScreenAccess(e)}},[]),h=(0,r.useCallback)(async function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await i.A.hasDataAccess(e,s)}catch(n){return console.warn("Data access check failed, using fallback:",n),i.A.getFallbackDataAccess(e,s)}},[]),d=(0,r.useCallback)(async function(e,s){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{return await i.A.hasPlantDataAccess(e,s,a)}catch(n){return console.warn("Plant data access check failed, using fallback:",n),i.A.getFallbackPlantDataAccess(e,s,a)}},[]),A=(0,r.useCallback)(async function(e,s,a){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};try{return await i.A.makeAccessDecision(e,s,a,r)}catch(n){return console.warn("Access decision failed, using fallback:",n),i.A.getFallbackAccessDecision(e,s,a,r)}},[]),y=(0,r.useCallback)((e,s)=>i.A.filterDataByPlantAccess(e,s),[]);return{loading:a,error:n,isAuthenticated:(0,t.wR)(),currentUser:(0,t.HW)(),primaryRole:(0,t.Jv)(),userPlants:(0,t.nT)(),primaryPlant:(0,t.bN)(),isAdmin:(0,t.qc)(),isJvcUser:(0,t.bV)(),isCqsUser:(0,t.po)(),isTechUser:(0,t.C9)(),isPlantUser:(0,t.X9)(),isViewer:(0,t.Z$)(),accessSummary:e,hasRole:e=>(0,t.hf)(e),hasAnyRole:e=>e.some(e=>(0,t.hf)(e)),hasAllRoles:e=>e.every(e=>(0,t.hf)(e)),checkScreenAccess:u,checkDataAccess:h,checkPlantDataAccess:d,makeAccessDecision:A,filterByPlantAccess:y,refresh:o}}}}]);
//# sourceMappingURL=766.7d4fe9e0.chunk.js.map