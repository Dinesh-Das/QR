"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[475],{2868:(e,s,t)=>{t.d(s,{aZ:()=>u,lX:()=>p,rb:()=>a,Bq:()=>c,fz:()=>r,cS:()=>o,tS:()=>g,r0:()=>d,EW:()=>l,sB:()=>n,Fv:()=>i});const l={MOBILE_BREAKPOINT:768,TABLET_BREAKPOINT:1024,PAGE_SIZE:10,DEBOUNCE_DELAY:300},i={INITIATED:"INITIATED",IN_PROGRESS:"IN_PROGRESS",PENDING_REVIEW:"PENDING_REVIEW",APPROVED:"APPROVED",REJECTED:"REJECTED",COMPLETED:"COMPLETED"},r={LOW:"LOW",MEDIUM:"MEDIUM",HIGH:"HIGH",URGENT:"URGENT",CRITICAL:"CRITICAL"},a=(i.INITIATED,i.IN_PROGRESS,i.PENDING_REVIEW,i.APPROVED,i.REJECTED,i.COMPLETED,r.LOW,r.MEDIUM,r.HIGH,r.URGENT,r.CRITICAL,{MAX_UPLOAD_SIZE:26214400,BYTES_PER_KB:1024,BYTES_PER_MB:1048576,BYTES_PER_GB:1073741824}),n={JVC_PENDING:"JVC_PENDING",PLANT_PENDING:"PLANT_PENDING",CQS_PENDING:"CQS_PENDING",TECH_PENDING:"TECH_PENDING",DRAFT:"DRAFT",IN_PROGRESS:"IN_PROGRESS",SUBMITTED:"SUBMITTED"},o={OPEN:"OPEN",RESOLVED:"RESOLVED",CLOSED:"CLOSED"},d={CQS:"CQS",TECH:"TECH",JVC:"JVC",PLANT:"PLANT"},u={INTERVAL:3e4,DEBOUNCE_DELAY:2e3},c={DEFAULT_PAGE_SIZE:10,SMALL_PAGE_SIZE:5,LARGE_PAGE_SIZE:15,SHOW_SIZE_CHANGER:!0,SHOW_QUICK_JUMPER:!0},p={ALL:"all",COMPLETED:"completed",IN_PROGRESS:"in-progress",NOT_STARTED:"not-started"},g={INITIATE:"initiate",PENDING:"pending",COMPLETED:"completed",QUERIES:"queries",HISTORY:"history"}},3661:(e,s,t)=>{t.d(s,{B:()=>i});var l=t(6649);const i={createQuery:(e,s)=>l.default.post(`/queries/workflow/${e}`,s),getQuery:e=>l.default.get(`/queries/${e}`),updateQuery:(e,s)=>l.default.put(`/queries/${e}`,s),deleteQuery:e=>l.default.delete(`/queries/${e}`),resolveQuery:(e,s)=>l.default.post(`/queries/${e}/resolve`,s),reopenQuery:(e,s)=>l.default.post(`/queries/${e}/reopen`,{reason:s}),assignQuery:(e,s)=>l.default.post(`/queries/${e}/assign`,s),reassignQuery:(e,s,t)=>l.default.put(`/queries/${e}/assign`,{team:s,reason:t}),getQueriesByWorkflow:e=>l.default.get(`/queries/workflow/${e}`),getQueriesByTeam:e=>l.default.get(`/queries/team/${e}`),getQueriesByStatus:e=>l.default.get(`/queries/status/${e}`),getQueriesByUser:e=>l.default.get("/queries/my-raised"),searchQueries:e=>{const s=new URLSearchParams(e).toString();return l.default.get(`/queries/search?${s}`)},getQueryStats:e=>l.default.get(`/queries/recent?days=${e}`),getQueryCountsByTeam:e=>l.default.get(`/queries/stats/count-open/${e}`),getAvgResolutionTimeByTeam:e=>l.default.get(`/queries/stats/avg-resolution-time/${e}`),getOverdueQueries:function(){return l.default.get("/queries/overdue")},getOverdueQueriesCountByTeam:e=>l.default.get(`/queries/stats/overdue-count/${e}`),getQueriesResolvedTodayByTeam:e=>l.default.get(`/queries/stats/resolved-today/${e}`),getQuerySLAStatus:e=>l.default.get(`/queries/${e}/is-overdue`),getQueriesNearingSLA:function(){return l.default.get("/queries/needing-attention")},addQueryComment:(e,s)=>l.default.post(`/queries/${e}/comments`,{comment:s}),getQueryComments:e=>l.default.get(`/queries/${e}/comments`),updateQueryPriority:(e,s)=>l.default.put(`/queries/${e}/priority`,{priority:s}),escalateQuery:(e,s)=>l.default.put(`/queries/${e}/priority`,{priorityLevel:"HIGH"}),uploadQueryDocuments:(e,s)=>l.default.upload(`/queries/${e}/documents`,s),uploadResponseDocuments:(e,s,t)=>l.default.upload(`/queries/${e}/responses/${s}/documents`,t),getQueryDocuments:e=>l.default.get(`/queries/${e}/documents`),downloadQueryDocument:(e,s)=>l.default.download(`/queries/${e}/documents/${s}/download`),deleteQueryDocument:(e,s)=>l.default.delete(`/queries/${e}/documents/${s}`)}},5423:(e,s,t)=>{t.d(s,{PK:()=>p,kz:()=>u,m6:()=>c,ww:()=>d,yE:()=>g});var l=t(4135),i=t(1686),r=(t(5043),t(3719)),a=t(1028),n=t(579);const o=e=>{let{children:s,roles:t=[],requireAll:a=!1,fallback:o=null,loading:d=!1,showFallback:u=!0}=e;if(d)return(0,n.jsx)(i.A,{size:"large"});if(!(0,r.wR)())return u?(0,n.jsx)(l.Ay,{status:"warning",title:"Authentication Required",subTitle:"Please log in to access this content."}):null;if(!t||0===t.length)return s;const c=(0,r.qc)(),p=a?t.every(e=>(0,r.hf)(e)):t.some(e=>(0,r.hf)(e));return c||p?s:o||(u?(0,n.jsx)(l.Ay,{status:"403",title:"Access Denied",subTitle:`This content requires one of the following roles: ${t.join(", ")} or ADMIN privileges`}):null)},d=e=>{let{children:s,fallback:t=null,showFallback:i=!0}=e;if(!(0,r.wR)())return i?(0,n.jsx)(l.Ay,{status:"warning",title:"Authentication Required",subTitle:"Please log in to access this content."}):null;const o=(0,r.HW)(),d=(0,r.qc)(),u=(0,r.hf)("ADMIN"),c=(0,r.hf)("admin"),p=(0,r.hf)("ROLE_ADMIN"),g=(0,r.gf)();let m=!1,f=!1;if(g)try{var E,h;const e=a.A.getTokenPayload(g);m=!0===(null===e||void 0===e?void 0:e.isAdmin),f=(null===e||void 0===e||null===(E=e.roles)||void 0===E?void 0:E.includes("ADMIN"))||(null===e||void 0===e||null===(h=e.authorities)||void 0===h?void 0:h.includes("ADMIN"))}catch(A){console.error("Error checking token in AdminOnly:",A)}const y=d||u||c||p||m||f;return console.log("AdminOnly Enhanced Debug:",{currentUser:o,adminStatus:d,hasAdminRole:u,hasAdminRoleLower:c,hasRoleAdmin:p,tokenIsAdmin:m,tokenHasAdminRole:f,finalHasAccess:y,token:g?"present":"missing"}),y?s:t||(i?(0,n.jsx)(l.Ay,{status:"403",title:"Access Denied",subTitle:`This content requires administrator privileges. Debug: user=${o}, isAdmin=${d}, hasRole=${u}, tokenAdmin=${m}`}):null)},u=e=>{let{children:s,fallback:t=null,showFallback:l=!0}=e;return(0,n.jsx)(o,{roles:["JVC_USER","JVC_ROLE","ADMIN"],fallback:t,showFallback:l,children:s})},c=e=>{let{children:s,fallback:t=null,showFallback:l=!0}=e;return(0,n.jsx)(o,{roles:["CQS_USER","CQS_ROLE","ADMIN"],fallback:t,showFallback:l,children:s})},p=e=>{let{children:s,fallback:t=null,showFallback:l=!0}=e;return(0,n.jsx)(o,{roles:["TECH_USER","TECH_ROLE","ADMIN"],fallback:t,showFallback:l,children:s})},g=e=>{let{children:s,fallback:t=null,showFallback:l=!0}=e;return(0,n.jsx)(o,{roles:["PLANT_USER","PLANT_ROLE","ADMIN"],fallback:t,showFallback:l,children:s})}},7933:(e,s,t)=>{t.d(s,{A:()=>R});var l=t(6237),i=t(1966),r=t(9470),a=t(132),n=t(4733),o=t(2261),d=t(5206),u=t(9073),c=t(4522),p=t(6569),g=t(7692),m=t(6051),f=t(3927),E=t(9677),h=t(5043),y=t(2868),A=t(3661),I=t(579);const{Text:x}=f.A,{Dragger:D}=E.A,R=e=>{let{queryId:s,responseId:t,onUploadComplete:f,maxFiles:E=5,disabled:R=!1,context:T="query"}=e;const[N,j]=(0,h.useState)([]),[P,S]=(0,h.useState)(!1),[C,O]=(0,h.useState)(0),_=e=>{if(0===e)return"0 Bytes";const s=Math.floor(Math.log(e)/Math.log(1024));return`${parseFloat((e/Math.pow(1024,s)).toFixed(2))} ${["Bytes","KB","MB","GB"][s]}`},$="response"===T?"Response":"Query",w=N.filter(e=>"done"===e.status).length;return(0,I.jsx)(u.A,{size:"small",title:(0,I.jsxs)(m.A,{children:[(0,I.jsx)(n.A,{}),(0,I.jsxs)("span",{children:["Upload Documents to ",$]})]}),style:{backgroundColor:"#fafafa",border:"1px dashed #d9d9d9"},children:(0,I.jsxs)(m.A,{direction:"vertical",style:{width:"100%"},children:[(0,I.jsx)(o.A,{message:`Document Upload for ${$}`,description:(0,I.jsxs)("ul",{style:{margin:0,paddingLeft:20},children:[(0,I.jsx)("li",{children:"Supported formats: PDF, Word (.doc, .docx), Excel (.xls, .xlsx), Images (JPG, PNG)"}),(0,I.jsx)("li",{children:"Maximum file size: 25MB per file"}),(0,I.jsxs)("li",{children:["Maximum ",E," files allowed"]}),(0,I.jsxs)("li",{children:["Files will be attached to this ",T.toLowerCase()]})]}),type:"info",showIcon:!0,size:"small",style:{marginBottom:16}}),(0,I.jsxs)(D,{multiple:!0,fileList:N,onChange:e=>{let{fileList:s}=e;s.length>E&&(p.Ay.warning(`Maximum ${E} files allowed. Only the first ${E} files will be processed.`),s=s.slice(0,E));const t=s.map(e=>{if(e.originFileObj){const s=(e=>{const s=y.rb.MAX_UPLOAD_SIZE,t=e.name.toLowerCase().substring(e.name.lastIndexOf("."));return{isValidType:["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","image/jpeg","image/jpg","image/png"].includes(e.type)||[".pdf",".doc",".docx",".xls",".xlsx",".jpg",".jpeg",".png"].includes(t),isValidSize:e.size<=s,type:e.type,size:e.size,extension:t}})(e.originFileObj);s.isValidType?s.isValidSize?(e.status="done",e.percent=100):(e.status="error",e.response=`File size exceeds 25MB limit (${(e.originFileObj.size/1024/1024).toFixed(2)}MB).`):(e.status="error",e.response="Invalid file type. Only PDF, Word, Excel, and image files (JPG, PNG) are allowed."),e.size=e.originFileObj.size,e.type=e.originFileObj.type,e.lastModified=e.originFileObj.lastModified}return e});j(t);const l=t.filter(e=>"done"===e.status).length,i=t.filter(e=>"error"===e.status).length;i>0?p.Ay.warning(`${i} file(s) have validation errors. Please check file types and sizes.`):l>0&&p.Ay.success(`${l} file(s) ready for upload.`)},beforeUpload:()=>!1,accept:".pdf,.doc,.docx,.xls,.xlsx,.jpg,.jpeg,.png",disabled:R||P,style:{marginBottom:16},children:[(0,I.jsx)("p",{className:"ant-upload-drag-icon",children:(0,I.jsx)(a.A,{})}),(0,I.jsx)("p",{className:"ant-upload-text",children:"Click or drag files to this area to upload"}),(0,I.jsx)("p",{className:"ant-upload-hint",children:"Support for PDF, Word, Excel, and image files. Maximum 25MB each."})]}),P&&C>0&&(0,I.jsx)(u.A,{size:"small",style:{marginBottom:16},children:(0,I.jsxs)(m.A,{direction:"vertical",style:{width:"100%"},children:[(0,I.jsx)(x,{children:"Uploading documents..."}),(0,I.jsx)(g.A,{percent:C,status:100===C?"success":"active",strokeColor:{"0%":"#108ee9","100%":"#87d068"}})]})}),N.length>0&&(0,I.jsx)(u.A,{size:"small",title:`Selected Files (${N.length}/${E})`,style:{marginBottom:16},children:(0,I.jsx)(c.A,{size:"small",dataSource:N,renderItem:e=>(0,I.jsx)(c.A.Item,{actions:[(0,I.jsx)(d.Ay,{type:"text",danger:!0,icon:(0,I.jsx)(i.A,{}),onClick:()=>(e=>{const s=N.filter(s=>s.uid!==e.uid);j(s)})(e),size:"small",disabled:P,children:"Remove"},"remove")],children:(0,I.jsx)(c.A.Item.Meta,{avatar:"done"===e.status?(0,I.jsx)(l.A,{style:{color:"#52c41a"}}):(0,I.jsx)(r.A,{style:{color:"#ff4d4f"}}),title:(0,I.jsxs)(m.A,{children:[(0,I.jsx)(x,{strong:"done"===e.status,type:"error"===e.status?"danger":"default",children:e.name}),e.size&&(0,I.jsxs)(x,{type:"secondary",children:["(",_(e.size),")"]})]}),description:"error"===e.status?(0,I.jsx)(x,{type:"danger",children:e.response}):(0,I.jsx)(x,{type:"secondary",children:"Ready for upload"})})})})}),(0,I.jsx)("div",{style:{textAlign:"center"},children:(0,I.jsx)(d.Ay,{type:"primary",icon:(0,I.jsx)(n.A,{}),onClick:async()=>{const e=N.filter(e=>"done"===e.status);if(0!==e.length)if(s)try{S(!0),O(0);const l=e.map(e=>e.originFileObj||e),i=setInterval(()=>{O(e=>e>=90?(clearInterval(i),90):e+10)},200);let r;r="response"===T&&t?await A.B.uploadResponseDocuments(s,t,l):await A.B.uploadQueryDocuments(s,l),clearInterval(i),O(100),p.Ay.success(`Successfully uploaded ${e.length} document(s) to the ${T}.`),j([]),O(0),f&&f(r)}catch(l){console.error("Error uploading documents:",l),p.Ay.error(`Failed to upload documents to ${T}. Please try again.`),O(0)}finally{S(!1)}else p.Ay.error("Query ID is required for document upload.");else p.Ay.error("Please select at least one valid file to upload.")},loading:P,disabled:R||0===w,size:"large",children:P?`Uploading ${w} Document(s)...`:`Upload ${w} Document(s) to ${$}`})}),N.length>0&&(0,I.jsx)(o.A,{message:"File Validation Summary",description:(0,I.jsxs)(m.A,{direction:"vertical",size:"small",children:[(0,I.jsxs)(x,{children:[(0,I.jsx)(l.A,{style:{color:"#52c41a",marginRight:4}}),"Valid files: ",w]}),N.filter(e=>"error"===e.status).length>0&&(0,I.jsxs)(x,{type:"danger",children:[(0,I.jsx)(r.A,{style:{marginRight:4}}),"Files with errors: ",N.filter(e=>"error"===e.status).length]})]}),type:N.filter(e=>"error"===e.status).length>0?"warning":"success",showIcon:!0,size:"small"})]})})}}}]);
//# sourceMappingURL=475.efd13b63.chunk.js.map