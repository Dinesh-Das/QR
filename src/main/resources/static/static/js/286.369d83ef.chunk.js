"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[286],{7286:(e,t,a)=>{a.r(t),a.d(t,{default:()=>g});var l=a(5206),s=a(1645),i=a(487),n=a(9098),r=a(5444),d=a(6569),o=a(7419),c=a(6553),u=a(3217),y=a(3927),h=a(5043),A=a(6649),p=a(579);const{Title:x}=y.A,g=()=>{const[e,t]=(0,h.useState)([]),[a,y]=(0,h.useState)(!1),[g]=n.A.useForm(),[m,j]=(0,h.useState)(!1),f=async e=>{y(!0);try{const a=await A.default.get("/audit/logs",{signal:e});if(null===e||void 0===e||!e.aborted){const e=Array.isArray(a)?a:[];t(e)}}catch(a){null!==e&&void 0!==e&&e.aborted||(d.Ay.error("Failed to fetch audit logs"),console.error("Error fetching audit logs:",a),t([]))}finally{null!==e&&void 0!==e&&e.aborted||y(!1)}};(0,h.useEffect)(()=>{const e=new AbortController;return f(e.signal),()=>{e.abort()}},[]);const I=[{title:"Timestamp",dataIndex:"timestamp",key:"timestamp",sorter:(e,t)=>new Date(e.timestamp)-new Date(t.timestamp)},{title:"User",dataIndex:"user",key:"user",sorter:(e,t)=>e.user.localeCompare(t.user)},{title:"Action",dataIndex:"action",key:"action",sorter:(e,t)=>e.action.localeCompare(t.action)},{title:"Details",dataIndex:"details",key:"details",width:"40%"}];return(0,p.jsxs)("div",{children:[(0,p.jsx)(x,{level:2,children:"Audit Logs"}),(0,p.jsx)(n.A,{form:g,layout:"vertical",onFinish:e=>{j(!0),(async e=>{y(!0);let a="/audit/logs";if(e)if(e.userId)a=`/audit/logs/user/${e.userId}`;else if(e.action)a=`/audit/logs/action/${e.action}`;else if(e.entityType)a=`/audit/logs/entity/${e.entityType}`;else if(e.severity)a=`/audit/logs/severity/${e.severity}`;else if(e.dateRange&&2===e.dateRange.length){const[t,l]=e.dateRange;a=`/audit/logs/date?start=${t.toISOString()}&end=${l.toISOString()}`}try{const e=await A.default.get(a),l=Array.isArray(e)?e:[];t(l)}catch(l){d.Ay.error("Failed to fetch audit logs"),console.error("Error fetching filtered audit logs:",l),t([])}finally{y(!1)}})(e).then(()=>j(!1))},style:{marginBottom:24},children:(0,p.jsxs)(o.A,{gutter:16,children:[(0,p.jsx)(s.A,{span:4,children:(0,p.jsx)(n.A.Item,{name:"userId",label:"User ID",children:(0,p.jsx)(r.A,{placeholder:"User ID"})})}),(0,p.jsx)(s.A,{span:4,children:(0,p.jsx)(n.A.Item,{name:"action",label:"Action",children:(0,p.jsx)(r.A,{placeholder:"Action"})})}),(0,p.jsx)(s.A,{span:4,children:(0,p.jsx)(n.A.Item,{name:"entityType",label:"Entity",children:(0,p.jsx)(r.A,{placeholder:"Entity Type"})})}),(0,p.jsx)(s.A,{span:4,children:(0,p.jsx)(n.A.Item,{name:"severity",label:"Severity",children:(0,p.jsxs)(c.A,{allowClear:!0,placeholder:"Select severity",children:[(0,p.jsx)(c.A.Option,{value:"INFO",children:"INFO"}),(0,p.jsx)(c.A.Option,{value:"WARN",children:"WARN"}),(0,p.jsx)(c.A.Option,{value:"ERROR",children:"ERROR"}),(0,p.jsx)(c.A.Option,{value:"SECURITY",children:"SECURITY"})]})})}),(0,p.jsx)(s.A,{span:6,children:(0,p.jsx)(n.A.Item,{name:"dateRange",label:"Date Range",children:(0,p.jsx)(i.A.RangePicker,{showTime:!0,style:{width:"100%"}})})}),(0,p.jsx)(s.A,{span:2,style:{display:"flex",alignItems:"end"},children:(0,p.jsx)(l.Ay,{type:"primary",htmlType:"submit",loading:m,children:"Filter"})}),(0,p.jsx)(s.A,{span:2,style:{display:"flex",alignItems:"end"},children:(0,p.jsx)(l.Ay,{onClick:()=>{g.resetFields(),f()},children:"Reset"})})]})}),(0,p.jsx)(u.A,{columns:I,dataSource:e,rowKey:"id",loading:a,bordered:!0})]})}}}]);
//# sourceMappingURL=286.369d83ef.chunk.js.map