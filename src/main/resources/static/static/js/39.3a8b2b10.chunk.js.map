{"version":3,"file":"static/js/39.3a8b2b10.chunk.js","mappings":"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","sources":["../node_modules/@ant-design/icons-svg/es/asn/InfoCircleOutlined.js","../node_modules/@ant-design/icons/es/icons/InfoCircleOutlined.js","utils/dataUtils.js","components/ErrorBoundaries/UserErrorBoundary.js","components/User/NotificationPreferencesPreview.js","hooks/usePlantAssignment.js","components/User/PlantAssignmentForm.js","components/User/UserModal.js","components/User/UserTable.js","hooks/useUserManagement.js","screens/Users.js","components/SecureForm.js","../node_modules/antd/es/tag/style/index.js","../node_modules/antd/es/tag/CheckableTag.js","../node_modules/antd/es/tag/style/presetCmp.js","../node_modules/antd/es/tag/style/statusCmp.js","../node_modules/antd/es/_util/capitalize.js","../node_modules/antd/es/tag/index.js","services/userAPI.js","services/masterDataAPI.js"],"sourcesContent":["// This icon file is generated automatically.\nvar InfoCircleOutlined = { \"icon\": { \"tag\": \"svg\", \"attrs\": { \"viewBox\": \"64 64 896 896\", \"focusable\": \"false\" }, \"children\": [{ \"tag\": \"path\", \"attrs\": { \"d\": \"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z\" } }, { \"tag\": \"path\", \"attrs\": { \"d\": \"M464 336a48 48 0 1096 0 48 48 0 10-96 0zm72 112h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V456c0-4.4-3.6-8-8-8z\" } }] }, \"name\": \"info-circle\", \"theme\": \"outlined\" };\nexport default InfoCircleOutlined;\n","import _extends from \"@babel/runtime/helpers/esm/extends\";\n// GENERATE BY ./scripts/generate.ts\n// DON NOT EDIT IT MANUALLY\n\nimport * as React from 'react';\nimport InfoCircleOutlinedSvg from \"@ant-design/icons-svg/es/asn/InfoCircleOutlined\";\nimport AntdIcon from \"../components/AntdIcon\";\nvar InfoCircleOutlined = function InfoCircleOutlined(props, ref) {\n  return /*#__PURE__*/React.createElement(AntdIcon, _extends({}, props, {\n    ref: ref,\n    icon: InfoCircleOutlinedSvg\n  }));\n};\n\n/**![info-circle](data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iNTAiIGZpbGw9IiNjYWNhY2EiIHZpZXdCb3g9IjY0IDY0IDg5NiA4OTYiIGZvY3VzYWJsZT0iZmFsc2UiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTUxMiA2NEMyNjQuNiA2NCA2NCAyNjQuNiA2NCA1MTJzMjAwLjYgNDQ4IDQ0OCA0NDggNDQ4LTIwMC42IDQ0OC00NDhTNzU5LjQgNjQgNTEyIDY0em0wIDgyMGMtMjA1LjQgMC0zNzItMTY2LjYtMzcyLTM3MnMxNjYuNi0zNzIgMzcyLTM3MiAzNzIgMTY2LjYgMzcyIDM3Mi0xNjYuNiAzNzItMzcyIDM3MnoiIC8+PHBhdGggZD0iTTQ2NCAzMzZhNDggNDggMCAxMDk2IDAgNDggNDggMCAxMC05NiAwem03MiAxMTJoLTQ4Yy00LjQgMC04IDMuNi04IDh2MjcyYzAgNC40IDMuNiA4IDggOGg0OGM0LjQgMCA4LTMuNiA4LThWNDU2YzAtNC40LTMuNi04LTgtOHoiIC8+PC9zdmc+) */\nvar RefIcon = /*#__PURE__*/React.forwardRef(InfoCircleOutlined);\nif (process.env.NODE_ENV !== 'production') {\n  RefIcon.displayName = 'InfoCircleOutlined';\n}\nexport default RefIcon;","/**\n * @fileoverview Utility functions for safe data handling in React components\n * Provides functions to ensure data is always in the expected format for Table components\n * \n * @author QRMFG Development Team\n * @since 1.0.0\n */\n\n/**\n * Ensures the provided data is always an array\n * This prevents the \"G.some is not a function\" error in Ant Design Table components\n * \n * @param {any} data - The data to validate\n * @param {Array} fallback - Fallback array to use if data is not valid (default: [])\n * @returns {Array} Safe array that can be used with Table components\n * \n * @example\n * ```javascript\n * const safeUsers = ensureArray(users);\n * const safeRoles = ensureArray(roles, []);\n * ```\n */\nexport const ensureArray = (data, fallback = []) => {\n  if (Array.isArray(data)) {\n    return data;\n  }\n\n  console.warn('Data is not an array, using fallback:', { data, fallback });\n  return fallback;\n};\n\n/**\n * Safely processes API response data for Table components\n * Handles common API response patterns and ensures array output\n * \n * @param {any} response - API response data\n * @param {string} [dataKey] - Key to extract array from response object\n * @param {Array} [fallback] - Fallback array if extraction fails\n * @returns {Array} Safe array for Table components\n * \n * @example\n * ```javascript\n * // For direct array responses\n * const users = safeApiResponse(response);\n * \n * // For nested data\n * const users = safeApiResponse(response, 'users');\n * const roles = safeApiResponse(response, 'data.roles');\n * ```\n */\nexport const safeApiResponse = (response, dataKey = null, fallback = []) => {\n  if (!response) {\n    return fallback;\n  }\n\n  // If no dataKey specified, expect direct array\n  if (!dataKey) {\n    return ensureArray(response, fallback);\n  }\n\n  // Handle nested keys like 'data.users'\n  const keys = dataKey.split('.');\n  let data = response;\n\n  for (const key of keys) {\n    if (data && typeof data === 'object' && key in data) {\n      data = data[key];\n    } else {\n      console.warn(`Key '${key}' not found in response:`, response);\n      return fallback;\n    }\n  }\n\n  return ensureArray(data, fallback);\n};\n\n/**\n * Safely handles user roles data which can come in various formats\n * \n * @param {any} roles - Roles data from API\n * @returns {Array} Array of role objects with consistent structure\n */\nexport const safeRolesData = (roles) => {\n  const safeRoles = ensureArray(roles);\n\n  return safeRoles.map(role => {\n    if (typeof role === 'string') {\n      return { name: role, id: role };\n    }\n    if (typeof role === 'object' && role !== null) {\n      return {\n        name: role.name || role.roleName || role.id || 'Unknown Role',\n        id: role.id || role.name || role.roleName || Math.random().toString(36),\n        ...role\n      };\n    }\n    return { name: 'Unknown Role', id: Math.random().toString(36) };\n  });\n};\n\n/**\n * Safely handles plant assignment data which can come in various formats\n * \n * @param {any} plantData - Plant assignment data from API\n * @returns {Object} Normalized plant assignment object\n */\nexport const safePlantData = (plantData) => {\n  if (!plantData) {\n    return { assignedPlants: [], primaryPlant: null };\n  }\n\n  // If plantData is directly an array\n  if (Array.isArray(plantData)) {\n    return {\n      assignedPlants: plantData,\n      primaryPlant: plantData.length > 0 ? plantData[0] : null\n    };\n  }\n\n  // If plantData is an object\n  if (typeof plantData === 'object') {\n    return {\n      assignedPlants: ensureArray(plantData.assignedPlants || plantData.plants),\n      primaryPlant: plantData.primaryPlant || plantData.primary || null\n    };\n  }\n\n  return { assignedPlants: [], primaryPlant: null };\n};\n\n/**\n * Creates a safe error handler for API calls that sets empty arrays on error\n * \n * @param {Function} setStateFunction - React setState function\n * @param {string} [errorMessage] - Custom error message\n * @returns {Function} Error handler function\n */\nexport const createSafeErrorHandler = (setStateFunction, errorMessage = 'Failed to fetch data') => {\n  return (error, signal) => {\n    if (!signal?.aborted) {\n      console.error(errorMessage, error);\n      setStateFunction([]);\n    }\n  };\n};","import { Result, Button } from 'antd';\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nclass UserErrorBoundary extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { hasError: false, error: null, errorInfo: null };\n  }\n\n  static getDerivedStateFromError(error) {\n    return { hasError: true, error };\n  }\n\n  componentDidCatch(error, errorInfo) {\n    this.setState({\n      error,\n      errorInfo\n    });\n\n    // Report error to monitoring service\n    this.reportError(error, errorInfo, { \n      level: 'component',\n      component: 'UserManagement',\n      context: this.props.context || 'user-management'\n    });\n  }\n\n  reportError = (error, errorInfo, context) => {\n    // In a real application, this would send to a monitoring service\n    console.error('UserErrorBoundary caught an error:', {\n      error: error.message,\n      stack: error.stack,\n      errorInfo,\n      context,\n      timestamp: new Date().toISOString()\n    });\n\n    // Example: Send to monitoring service\n    // monitoringService.reportError({\n    //   message: error.message,\n    //   stack: error.stack,\n    //   component: context.component,\n    //   level: context.level,\n    //   timestamp: new Date().toISOString()\n    // });\n  };\n\n  handleRetry = () => {\n    this.setState({ hasError: false, error: null, errorInfo: null });\n    \n    // Call retry callback if provided\n    if (this.props.onRetry) {\n      this.props.onRetry();\n    }\n  };\n\n  handleGoHome = () => {\n    window.location.href = '/qrmfg';\n  };\n\n  render() {\n    if (this.state.hasError) {\n      return (\n        <Result\n          status=\"error\"\n          title=\"User Management Error\"\n          subTitle=\"Something went wrong while managing users. Please try again or contact support if the problem persists.\"\n          extra={[\n            <Button type=\"primary\" onClick={this.handleRetry} key=\"retry\">\n              Try Again\n            </Button>,\n            <Button onClick={this.handleGoHome} key=\"home\">\n              Go Home\n            </Button>\n          ]}\n          style={{ padding: '50px 0' }}\n        >\n          {process.env.NODE_ENV === 'development' && (\n            <div style={{ textAlign: 'left', marginTop: 20 }}>\n              <details style={{ whiteSpace: 'pre-wrap' }}>\n                <summary>Error Details (Development Only)</summary>\n                <div style={{ marginTop: 10, fontSize: '12px', color: '#666' }}>\n                  <strong>Error:</strong> {this.state.error?.message}\n                  <br />\n                  <strong>Stack:</strong>\n                  <pre style={{ fontSize: '11px', marginTop: 5 }}>\n                    {this.state.error?.stack}\n                  </pre>\n                  {this.state.errorInfo?.componentStack && (\n                    <>\n                      <strong>Component Stack:</strong>\n                      <pre style={{ fontSize: '11px', marginTop: 5 }}>\n                        {this.state.errorInfo.componentStack}\n                      </pre>\n                    </>\n                  )}\n                </div>\n              </details>\n            </div>\n          )}\n        </Result>\n      );\n    }\n\n    return this.props.children;\n  }\n}\n\nUserErrorBoundary.propTypes = {\n  children: PropTypes.node.isRequired,\n  context: PropTypes.string,\n  onRetry: PropTypes.func\n};\n\nUserErrorBoundary.defaultProps = {\n  context: 'user-management',\n  onRetry: null\n};\n\nexport default UserErrorBoundary;","import { BellOutlined, InfoCircleOutlined } from '@ant-design/icons';\r\nimport { Card, Alert, Row, Col, Typography, Tag, Spin } from 'antd';\r\nimport PropTypes from 'prop-types';\r\nimport React, { useState, useEffect, useCallback } from 'react';\r\n\r\nimport apiClient from '../../api/client';\r\n\r\nconst { Text, Title } = Typography;\r\n\r\n/**\r\n * NotificationPreferencesPreview Component\r\n * \r\n * Shows a preview of what notification preferences will be created for a new user\r\n * based on their selected roles and the current admin configuration.\r\n * \r\n * @component\r\n */\r\nconst NotificationPreferencesPreview = ({ selectedRoles, roles, visible }) => {\r\n  const [previewData, setPreviewData] = useState(null);\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  // Get the primary role name from selected role IDs\r\n  const getPrimaryRoleName = useCallback(() => {\r\n    if (!selectedRoles || selectedRoles.length === 0) return null;\r\n    \r\n    const primaryRoleId = selectedRoles[0];\r\n    const role = roles.find(r => r.id === primaryRoleId);\r\n    \r\n    if (!role) return null;\r\n    \r\n    // Convert role name to match backend format\r\n    // e.g., \"ROLE_CQS_USER\" -> \"CQS\" or \"JVC_USER\" -> \"JVC_USER\"\r\n    let roleName = role.name;\r\n    if (roleName.startsWith('ROLE_') && roleName.endsWith('_USER')) {\r\n      roleName = roleName.substring(5, roleName.length - 5);\r\n    } else if (roleName.startsWith('ROLE_')) {\r\n      roleName = roleName.substring(5);\r\n    }\r\n    // If the role name is already in format like \"JVC_USER\", keep it as is\r\n    // The backend will handle both \"JVC\" and \"JVC_USER\" mappings\r\n    \r\n    return roleName;\r\n  }, [selectedRoles, roles]);\r\n\r\n  // Load preview data when roles change\r\n  useEffect(() => {\r\n    const loadPreview = async () => {\r\n      const primaryRole = getPrimaryRoleName();\r\n      if (!primaryRole || !visible) {\r\n        setPreviewData(null);\r\n        return;\r\n      }\r\n\r\n      setLoading(true);\r\n      try {\r\n        const data = await apiClient.get(`/admin/notification-defaults/preview?role=${primaryRole}`);\r\n        if (data.success) {\r\n          setPreviewData({\r\n            role: primaryRole,\r\n            preferences: data.defaultPreferences\r\n          });\r\n        }\r\n      } catch (error) {\r\n        console.error('Failed to load notification preferences preview:', error);\r\n        setPreviewData(null);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    loadPreview();\r\n  }, [selectedRoles, roles, visible, getPrimaryRoleName]);\r\n\r\n  if (!visible || !selectedRoles || selectedRoles.length === 0) {\r\n    return null;\r\n  }\r\n\r\n  const primaryRole = getPrimaryRoleName();\r\n\r\n  return (\r\n    <Card\r\n      title={\r\n        <span>\r\n          <BellOutlined style={{ marginRight: 8 }} />\r\n          Notification Preferences Preview\r\n        </span>\r\n      }\r\n      size=\"small\"\r\n      style={{ marginTop: 16 }}\r\n    >\r\n      <Alert\r\n        message=\"Default Notification Preferences\"\r\n        description={`The following notification preferences will be automatically created for this user based on their ${primaryRole} role.`}\r\n        type=\"info\"\r\n        showIcon\r\n        icon={<InfoCircleOutlined />}\r\n        style={{ marginBottom: 16 }}\r\n      />\r\n\r\n      {loading ? (\r\n        <div style={{ textAlign: 'center', padding: 20 }}>\r\n          <Spin size=\"small\" />\r\n          <Text style={{ marginLeft: 8 }}>Loading preview...</Text>\r\n        </div>\r\n      ) : previewData ? (\r\n        <div>\r\n          <div style={{ marginBottom: 12 }}>\r\n            <Text strong>Primary Role: </Text>\r\n            <Tag color=\"blue\">{previewData.role}</Tag>\r\n          </div>\r\n          \r\n          <Title level={5} style={{ marginBottom: 12 }}>\r\n            Notification Types:\r\n          </Title>\r\n          \r\n          <Row gutter={[8, 8]}>\r\n            {Object.entries(previewData.preferences).map(([type, enabled]) => (\r\n              <Col xs={24} sm={12} md={8} key={type}>\r\n                <div style={{\r\n                  padding: '6px 10px',\r\n                  backgroundColor: enabled ? '#f6ffed' : '#fff2f0',\r\n                  border: `1px solid ${enabled ? '#b7eb8f' : '#ffccc7'}`,\r\n                  borderRadius: '4px',\r\n                  display: 'flex',\r\n                  justifyContent: 'space-between',\r\n                  alignItems: 'center'\r\n                }}>\r\n                  <Text style={{ fontSize: '12px' }}>\r\n                    {type.replace(/_/g, ' ')}\r\n                  </Text>\r\n                  <Tag \r\n                    color={enabled ? 'success' : 'default'} \r\n                    size=\"small\"\r\n                  >\r\n                    {enabled ? 'ON' : 'OFF'}\r\n                  </Tag>\r\n                </div>\r\n              </Col>\r\n            ))}\r\n          </Row>\r\n          \r\n          <Alert\r\n            message=\"User Customization\"\r\n            description=\"After creation, the user can modify these preferences in their settings.\"\r\n            type=\"success\"\r\n            showIcon\r\n            style={{ marginTop: 12 }}\r\n            size=\"small\"\r\n          />\r\n        </div>\r\n      ) : (\r\n        <Alert\r\n          message=\"Preview Unavailable\"\r\n          description=\"Could not load notification preferences preview for the selected role.\"\r\n          type=\"warning\"\r\n          showIcon\r\n          size=\"small\"\r\n        />\r\n      )}\r\n    </Card>\r\n  );\r\n};\r\n\r\nNotificationPreferencesPreview.propTypes = {\r\n  selectedRoles: PropTypes.array,\r\n  roles: PropTypes.array.isRequired,\r\n  visible: PropTypes.bool.isRequired\r\n};\r\n\r\nNotificationPreferencesPreview.defaultProps = {\r\n  selectedRoles: []\r\n};\r\n\r\nexport default NotificationPreferencesPreview;","import { message } from 'antd';\nimport { useState, useCallback, useEffect, useMemo } from 'react';\n\nimport { masterDataAPI } from '../services/masterDataAPI';\n\nexport const usePlantAssignment = () => {\n  const [availablePlants, setAvailablePlants] = useState([]);\n  const [plantsLoading, setPlantsLoading] = useState(false);\n  const [error, setError] = useState(null);\n\n  // Fetch plants from master data API\n  const fetchPlants = useCallback(async (signal) => {\n    setPlantsLoading(true);\n    setError(null);\n    \n    try {\n      const locations = await masterDataAPI.getAllLocations({ signal });\n      if (!signal?.aborted) {\n        const plantOptions = locations.map(location => ({\n          label: `${location.locationCode} - ${location.description}`,\n          value: location.locationCode,\n          key: location.locationCode\n        }));\n        setAvailablePlants(plantOptions);\n      }\n    } catch (err) {\n      if (!signal?.aborted) {\n        console.error('Failed to fetch plants:', err);\n        setError(err.message);\n        message.warning('Failed to fetch plants from location master, using fallback data');\n\n        // Fallback plant data\n        const fallbackPlants = [\n          { label: '1107 - Manufacturing Unit 1107', value: '1107', key: '1107' },\n          { label: '1106 - Manufacturing Unit 1106', value: '1106', key: '1106' },\n          { label: '1104 - Manufacturing Unit 1104', value: '1104', key: '1104' },\n          { label: '1103 - Manufacturing Unit 1103', value: '1103', key: '1103' },\n          { label: '1102 - Manufacturing Unit 1102', value: '1102', key: '1102' }\n        ];\n        setAvailablePlants(fallbackPlants);\n      }\n    } finally {\n      if (!signal?.aborted) {\n        setPlantsLoading(false);\n      }\n    }\n  }, []);\n\n  // Get plant description by code\n  const getPlantDescription = useCallback((plantCode) => {\n    const plant = availablePlants.find(p => p.value === plantCode);\n    return plant ? plant.label : plantCode;\n  }, [availablePlants]);\n\n  // Validate plant assignments\n  const validatePlantAssignments = useCallback((assignedPlants, primaryPlant) => {\n    const errors = [];\n\n    if (!assignedPlants || assignedPlants.length === 0) {\n      errors.push('At least one plant must be assigned');\n    }\n\n    if (primaryPlant && assignedPlants && !assignedPlants.includes(primaryPlant)) {\n      errors.push('Primary plant must be one of the assigned plants');\n    }\n\n    return errors;\n  }, []);\n\n  // Filter available plants based on search\n  const filterPlants = useCallback((input, option) => {\n    return option?.label?.toLowerCase().includes(input.toLowerCase());\n  }, []);\n\n  // Get plants that are available for assignment (not already assigned)\n  const getAvailablePlantsForAssignment = useCallback((currentAssignments = []) => {\n    return availablePlants.filter(plant => !currentAssignments.includes(plant.value));\n  }, [availablePlants]);\n\n  // Initialize plants on mount\n  useEffect(() => {\n    const controller = new AbortController();\n    fetchPlants(controller.signal);\n\n    return () => {\n      controller.abort();\n    };\n  }, [fetchPlants]);\n\n  // Memoized plant options for primary plant selection\n  const primaryPlantOptions = useMemo(() => {\n    return availablePlants.map(plant => ({\n      ...plant,\n      disabled: false // All plants can be primary\n    }));\n  }, [availablePlants]);\n\n  return {\n    availablePlants,\n    plantsLoading,\n    error,\n    fetchPlants,\n    getPlantDescription,\n    validatePlantAssignments,\n    filterPlants,\n    getAvailablePlantsForAssignment,\n    primaryPlantOptions\n  };\n};","import { ReloadOutlined } from '@ant-design/icons';\nimport { Form, Select, Button, Divider, Typography, Space, Alert } from 'antd';\nimport PropTypes from 'prop-types';\nimport React, { useCallback, useMemo, useEffect } from 'react';\n\nimport { usePlantAssignment } from '../../hooks/usePlantAssignment';\n\nconst { Text } = Typography;\n\nconst PlantAssignmentForm = React.memo(({ \n  selectedRoles, \n  roles, \n  form,\n  initialValues = {}\n}) => {\n  const {\n    availablePlants,\n    plantsLoading,\n    error,\n    fetchPlants,\n    filterPlants,\n    validatePlantAssignments\n  } = usePlantAssignment();\n\n  // Check if selected roles include plant user role\n  const isPlantUserSelected = useMemo(() => {\n    if (!selectedRoles || !roles) return false;\n    \n    const plantRoleIds = roles\n      .filter(role => role.name === 'ROLE_PLANT_USER' || role.name === 'PLANT_USER')\n      .map(role => role.id);\n\n    return selectedRoles.some(roleId => plantRoleIds.includes(roleId));\n  }, [selectedRoles, roles]);\n\n  // Handle refresh plants button click\n  const handleRefreshPlants = useCallback(async () => {\n    const controller = new AbortController();\n    await fetchPlants(controller.signal);\n  }, [fetchPlants]);\n\n  // Custom validator for assigned plants\n  const validateAssignedPlants = useCallback((_, value) => {\n    if (!isPlantUserSelected) {\n      return Promise.resolve();\n    }\n\n    if (!value || value.length === 0) {\n      return Promise.reject(new Error('Please select at least one plant for plant users!'));\n    }\n\n    return Promise.resolve();\n  }, [isPlantUserSelected]);\n\n  // Custom validator for primary plant\n  const validatePrimaryPlant = useCallback((_, value) => {\n    if (!isPlantUserSelected) {\n      return Promise.resolve();\n    }\n\n    const assignedPlants = form.getFieldValue('assignedPlants') || [];\n    \n    if (value && !assignedPlants.includes(value)) {\n      return Promise.reject(new Error('Primary plant must be one of the assigned plants!'));\n    }\n\n    return Promise.resolve();\n  }, [isPlantUserSelected, form]);\n\n  // Handle assigned plants change to update primary plant options\n  const handleAssignedPlantsChange = useCallback((values) => {\n    const currentPrimaryPlant = form.getFieldValue('primaryPlant');\n    \n    // If current primary plant is not in the new assigned plants, clear it\n    if (currentPrimaryPlant && !values.includes(currentPrimaryPlant)) {\n      form.setFieldValue('primaryPlant', undefined);\n    }\n  }, [form]);\n\n  // Get primary plant options based on assigned plants\n  const primaryPlantOptions = useMemo(() => {\n    const assignedPlants = form.getFieldValue('assignedPlants') || [];\n    return availablePlants.filter(plant => assignedPlants.includes(plant.value));\n  }, [availablePlants, form]);\n\n  // Set initial values when component mounts or initialValues change\n  useEffect(() => {\n    if (initialValues.assignedPlants || initialValues.primaryPlant) {\n      form.setFieldsValue({\n        assignedPlants: initialValues.assignedPlants || [],\n        primaryPlant: initialValues.primaryPlant || null\n      });\n    }\n  }, [initialValues, form]);\n\n  // Don't render if plant user role is not selected\n  if (!isPlantUserSelected) {\n    return null;\n  }\n\n  return (\n    <>\n      <Divider />\n      <div\n        style={{\n          display: 'flex',\n          justifyContent: 'space-between',\n          alignItems: 'center',\n          marginBottom: 8\n        }}\n      >\n        <Text strong style={{ color: '#1890ff' }}>\n          Plant Assignments\n        </Text>\n        <Button \n          size=\"small\" \n          icon={<ReloadOutlined />}\n          onClick={handleRefreshPlants} \n          loading={plantsLoading}\n          aria-label=\"Refresh plants list\"\n          data-testid=\"refresh-plants-button\"\n        >\n          Refresh Plants\n        </Button>\n      </div>\n\n      <Text\n        type=\"secondary\"\n        style={{ display: 'block', marginBottom: 16, fontSize: '12px' }}\n      >\n        Plant users need to be assigned to specific plants to access plant-specific data.\n        Plants are loaded from Location Master.\n      </Text>\n\n      {error && (\n        <Alert\n          message=\"Plant Loading Error\"\n          description={`Failed to load plants: ${error}. Using fallback data.`}\n          type=\"warning\"\n          showIcon\n          style={{ marginBottom: 16 }}\n          data-testid=\"plant-error-alert\"\n        />\n      )}\n\n      <Form.Item\n        name=\"assignedPlants\"\n        label=\"Assigned Plants\"\n        rules={[\n          { validator: validateAssignedPlants }\n        ]}\n        hasFeedback\n        tooltip=\"Select all plants this user should have access to\"\n      >\n        <Select\n          mode=\"multiple\"\n          placeholder=\"Select plants this user can access\"\n          loading={plantsLoading}\n          options={availablePlants}\n          showSearch\n          filterOption={filterPlants}\n          onChange={handleAssignedPlantsChange}\n          aria-label=\"Assigned plants selection\"\n          data-testid=\"assigned-plants-select\"\n          maxTagCount=\"responsive\"\n          allowClear\n        />\n      </Form.Item>\n\n      <Form.Item\n        name=\"primaryPlant\"\n        label=\"Primary Plant\"\n        rules={[\n          { validator: validatePrimaryPlant }\n        ]}\n        hasFeedback\n        tooltip=\"The default plant that will be selected when the user logs in\"\n      >\n        <Select\n          placeholder=\"Select primary plant (optional)\"\n          allowClear\n          loading={plantsLoading}\n          options={primaryPlantOptions}\n          showSearch\n          filterOption={filterPlants}\n          aria-label=\"Primary plant selection\"\n          data-testid=\"primary-plant-select\"\n          disabled={!form.getFieldValue('assignedPlants')?.length}\n        />\n      </Form.Item>\n\n      {/* Helper text for primary plant */}\n      {form.getFieldValue('assignedPlants')?.length > 0 && (\n        <div style={{ marginTop: -16, marginBottom: 16 }}>\n          <Text type=\"secondary\" style={{ fontSize: '11px' }}>\n            Primary plant will be auto-selected from assigned plants if not specified\n          </Text>\n        </div>\n      )}\n    </>\n  );\n});\n\nPlantAssignmentForm.displayName = 'PlantAssignmentForm';\n\nPlantAssignmentForm.propTypes = {\n  selectedRoles: PropTypes.arrayOf(PropTypes.string),\n  roles: PropTypes.arrayOf(PropTypes.shape({\n    id: PropTypes.string.isRequired,\n    name: PropTypes.string.isRequired\n  })).isRequired,\n  form: PropTypes.object.isRequired,\n  initialValues: PropTypes.shape({\n    assignedPlants: PropTypes.arrayOf(PropTypes.string),\n    primaryPlant: PropTypes.string\n  })\n};\n\nPlantAssignmentForm.defaultProps = {\n  selectedRoles: [],\n  initialValues: {}\n};\n\nexport default PlantAssignmentForm;","import { Modal, Form, Input, Select } from 'antd';\nimport PropTypes from 'prop-types';\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\n\nimport { userAPI } from '../../services/userAPI';\nimport { ValidationRules } from '../../utils/inputValidation';\nimport SecureForm, { SecureInput, SecureFormItem } from '../SecureForm';\n\nimport NotificationPreferencesPreview from './NotificationPreferencesPreview';\nimport PlantAssignmentForm from './PlantAssignmentForm';\n\n/**\n * UserModal Component\n * \n * A modal dialog for creating and editing user information including roles and plant assignments.\n * Supports both create and edit modes with form validation and error handling.\n * \n * @component\n * @example\n * ```jsx\n * const roles = [\n *   { value: 'USER', label: 'User' },\n *   { value: 'ADMIN', label: 'Administrator' }\n * ];\n * \n * <UserModal\n *   visible={true}\n *   editingUser={{ id: '1', username: 'john', email: 'john@example.com' }}\n *   roles={roles}\n *   onSave={(userData) => console.log('Save user:', userData)}\n *   onCancel={() => console.log('Cancel edit')}\n *   loading={false}\n * />\n * ```\n * \n * @param {Object} props - Component props\n * @param {boolean} props.visible - Whether the modal is visible\n * @param {Object|null} props.editingUser - User object being edited (null for create mode)\n * @param {string} props.editingUser.id - User ID\n * @param {string} props.editingUser.username - Username\n * @param {string} props.editingUser.email - Email address\n * @param {Array<string>} props.editingUser.roles - User roles\n * @param {Array<Object>} props.roles - Available roles for selection\n * @param {string} props.roles[].value - Role value\n * @param {string} props.roles[].label - Role display name\n * @param {Function} props.onSave - Callback when user data is saved\n * @param {Function} props.onCancel - Callback when modal is cancelled\n * @param {boolean} [props.loading=false] - Whether save operation is in progress\n * \n * @returns {React.ReactElement} Rendered UserModal component\n * \n * @since 1.0.0\n * @author QRMFG Development Team\n */\nconst UserModal = React.memo(({ \n  visible, \n  editingUser, \n  roles, \n  onSave, \n  onCancel,\n  loading = false \n}) => {\n  const [form] = Form.useForm();\n  const [selectedRoles, setSelectedRoles] = useState([]);\n  const [plantAssignmentData, setPlantAssignmentData] = useState({});\n\n  // Determine if this is edit or create mode\n  const isEditMode = useMemo(() => Boolean(editingUser), [editingUser]);\n\n  // Modal title based on mode\n  const modalTitle = useMemo(() => \n    isEditMode ? 'Edit User' : 'Add User', \n    [isEditMode]\n  );\n\n  // Form validation rules with enhanced security\n  const validationRules = useMemo(() => ({\n    username: ValidationRules.username,\n    email: ValidationRules.email,\n    password: isEditMode ? [] : ValidationRules.password,\n    roles: [\n      { required: true, message: 'Please select at least one role!' },\n      { type: 'array', min: 1, message: 'Please select at least one role!' }\n    ]\n  }), [isEditMode]);\n\n  // Role options for select\n  const roleOptions = useMemo(() => \n    roles.map(role => ({\n      label: role.name,\n      value: role.id,\n      key: role.id\n    })), \n    [roles]\n  );\n\n  // Handle form submission\n  const handleSubmit = useCallback(async (values) => {\n    try {\n      await onSave(values, editingUser);\n      form.resetFields();\n    } catch (error) {\n      console.error('Error saving user:', error);\n      // Error message is handled in the parent component\n    }\n  }, [onSave, editingUser, form]);\n\n  // Handle modal cancel\n  const handleCancel = useCallback(() => {\n    form.resetFields();\n    onCancel();\n  }, [form, onCancel]);\n\n  // Handle modal OK button\n  const handleOk = useCallback(() => {\n    form.submit();\n  }, [form]);\n\n  // Load plant assignment data for editing user\n  const loadPlantAssignmentData = useCallback(async (username) => {\n    try {\n      const plantData = await userAPI.getUserPlantAssignments(username);\n      setPlantAssignmentData(plantData || {});\n      return plantData;\n    } catch (error) {\n      console.warn('Could not load plant assignments for user:', error);\n      setPlantAssignmentData({});\n      return {};\n    }\n  }, []);\n\n  // Reset form when modal opens/closes or editing user changes\n  useEffect(() => {\n    if (visible && editingUser) {\n      const userRoles = (editingUser.roles || []).map(r => r?.id).filter(Boolean);\n      setSelectedRoles(userRoles);\n      \n      // Populate form with editing user data\n      form.setFieldsValue({\n        username: editingUser.username,\n        email: editingUser.email,\n        roles: userRoles\n      });\n\n      // Load plant assignments for editing user\n      loadPlantAssignmentData(editingUser.username);\n    } else if (visible && !editingUser) {\n      // Reset form for new user\n      setSelectedRoles([]);\n      setPlantAssignmentData({});\n      form.resetFields();\n    }\n  }, [visible, editingUser, form, loadPlantAssignmentData]);\n\n  // Form layout configuration\n  const formLayout = {\n    labelCol: { span: 6 },\n    wrapperCol: { span: 18 }\n  };\n\n  return (\n    <Modal\n      title={modalTitle}\n      open={visible}\n      onOk={handleOk}\n      onCancel={handleCancel}\n      confirmLoading={loading}\n      destroyOnClose\n      width={600}\n      maskClosable={false}\n      aria-labelledby=\"user-modal-title\"\n      data-testid=\"user-modal\"\n    >\n      <SecureForm\n        form={form}\n        {...formLayout}\n        onFinish={handleSubmit}\n        preserve={false}\n        aria-label={`${modalTitle} form`}\n        data-testid=\"user-form\"\n        componentName=\"UserModal\"\n        enableSecurityLogging={true}\n      >\n        <SecureFormItem\n          name=\"username\"\n          label=\"Username\"\n          validationType=\"username\"\n          hasFeedback\n        >\n          <SecureInput\n            placeholder=\"Enter username\"\n            disabled={isEditMode} // Username cannot be changed in edit mode\n            aria-label=\"Username input\"\n            data-testid=\"username-input\"\n            validationType=\"username\"\n            componentName=\"UserModal\"\n            fieldName=\"username\"\n          />\n        </SecureFormItem>\n\n        <SecureFormItem\n          name=\"email\"\n          label=\"Email\"\n          validationType=\"email\"\n          hasFeedback\n        >\n          <SecureInput\n            placeholder=\"Enter email address\"\n            aria-label=\"Email input\"\n            data-testid=\"email-input\"\n            validationType=\"email\"\n            componentName=\"UserModal\"\n            fieldName=\"email\"\n          />\n        </SecureFormItem>\n\n        {!isEditMode && (\n          <SecureFormItem\n            name=\"password\"\n            label=\"Password\"\n            validationType=\"password\"\n            hasFeedback\n          >\n            <Input.Password\n              placeholder=\"Enter password\"\n              aria-label=\"Password input\"\n              data-testid=\"password-input\"\n            />\n          </SecureFormItem>\n        )}\n\n        <Form.Item\n          name=\"roles\"\n          label=\"Roles\"\n          rules={validationRules.roles}\n          hasFeedback\n        >\n          <Select\n            mode=\"multiple\"\n            placeholder=\"Select user roles\"\n            options={roleOptions}\n            aria-label=\"Roles selection\"\n            data-testid=\"roles-select\"\n            showSearch\n            filterOption={(input, option) =>\n              option?.label?.toLowerCase().includes(input.toLowerCase())\n            }\n            maxTagCount=\"responsive\"\n            onChange={setSelectedRoles}\n          />\n        </Form.Item>\n\n        {/* Plant Assignment Section */}\n        <PlantAssignmentForm\n          selectedRoles={selectedRoles}\n          roles={roles}\n          form={form}\n          initialValues={plantAssignmentData}\n        />\n\n        {/* Notification Preferences Preview (only for new users) */}\n        {!isEditMode && (\n          <NotificationPreferencesPreview\n            selectedRoles={selectedRoles}\n            roles={roles}\n            visible={visible}\n          />\n        )}\n      </SecureForm>\n    </Modal>\n  );\n});\n\nUserModal.displayName = 'UserModal';\n\nUserModal.propTypes = {\n  visible: PropTypes.bool.isRequired,\n  editingUser: PropTypes.shape({\n    id: PropTypes.string.isRequired,\n    username: PropTypes.string.isRequired,\n    email: PropTypes.string.isRequired,\n    roles: PropTypes.arrayOf(PropTypes.shape({\n      id: PropTypes.string,\n      name: PropTypes.string\n    }))\n  }),\n  roles: PropTypes.arrayOf(PropTypes.shape({\n    id: PropTypes.string.isRequired,\n    name: PropTypes.string.isRequired\n  })).isRequired,\n  onSave: PropTypes.func.isRequired,\n  onCancel: PropTypes.func.isRequired,\n  loading: PropTypes.bool\n};\n\nUserModal.defaultProps = {\n  editingUser: null,\n  loading: false\n};\n\nexport default UserModal;","import { EditOutlined, DeleteOutlined } from '@ant-design/icons';\nimport { Table, Button } from 'antd';\nimport PropTypes from 'prop-types';\nimport React, { useMemo, useCallback } from 'react';\n\n/**\n * UserTable Component\n * \n * A performant, accessible table component for displaying and managing users.\n * Features include sorting, editing, deletion, and plant assignment display.\n * \n * @component\n * @example\n * ```jsx\n * const users = [\n *   { id: '1', username: 'john', email: 'john@example.com', roles: ['USER'], plantAssignments: ['PLANT1'] }\n * ];\n * \n * <UserTable\n *   users={users}\n *   loading={false}\n *   onEdit={(user) => console.log('Edit user:', user)}\n *   onDelete={(userId) => console.log('Delete user:', userId)}\n *   availablePlants={[{ value: 'PLANT1', label: 'Plant 1' }]}\n * />\n * ```\n * \n * @param {Object} props - Component props\n * @param {Array<Object>} props.users - Array of user objects to display\n * @param {string} props.users[].id - Unique user identifier\n * @param {string} props.users[].username - User's username\n * @param {string} props.users[].email - User's email address\n * @param {Array<string>} props.users[].roles - User's assigned roles\n * @param {Array<string>} props.users[].plantAssignments - User's plant assignments\n * @param {boolean} props.loading - Whether the table is in loading state\n * @param {Function} props.onEdit - Callback function when edit button is clicked\n * @param {Function} props.onDelete - Callback function when delete button is clicked\n * @param {Array<Object>} [props.availablePlants=[]] - Available plants for display mapping\n * @param {string} props.availablePlants[].value - Plant code\n * @param {string} props.availablePlants[].label - Plant display name\n * \n * @returns {React.ReactElement} Rendered UserTable component\n * \n * @since 1.0.0\n * @author QRMFG Development Team\n */\nconst UserTable = React.memo(({ \n  users, \n  loading, \n  onEdit, \n  onDelete, \n  availablePlants = [] \n}) => {\n  // Memoized function to get plant description by code\n  const getPlantDescription = useCallback((plantCode) => {\n    const plant = availablePlants.find(p => p.value === plantCode);\n    return plant ? plant.label : plantCode;\n  }, [availablePlants]);\n\n  // Memoized column definitions\n  const columns = useMemo(() => [\n    {\n      title: 'Username',\n      dataIndex: 'username',\n      key: 'username',\n      sorter: (a, b) => a.username.localeCompare(b.username),\n      'aria-label': 'Username column'\n    },\n    {\n      title: 'Email',\n      dataIndex: 'email',\n      key: 'email',\n      sorter: (a, b) => a.email.localeCompare(b.email),\n      'aria-label': 'Email column'\n    },\n    {\n      title: 'Roles',\n      dataIndex: 'roles',\n      key: 'roles',\n      'aria-label': 'Roles column',\n      render: (roles) => {\n        // Ensure roles is always an array\n        const rolesArray = Array.isArray(roles) ? roles : [];\n        const roleNames = rolesArray\n          .map(role => role?.name || role || '')\n          .filter(Boolean)\n          .join(', ');\n          \n        return roleNames || 'No roles assigned';\n      }\n    },\n    {\n      title: 'Assigned Plants',\n      key: 'plants',\n      'aria-label': 'Assigned plants column',\n      render: (_, record) => {\n        // Handle multiple data sources for plant assignments\n        let assignedPlants = [];\n        let primaryPlant = null;\n        \n        // Check for plantAssignments (from hook)\n        if (record.plantAssignments) {\n          if (Array.isArray(record.plantAssignments)) {\n            assignedPlants = record.plantAssignments;\n          } else if (record.plantAssignments.assignedPlants && Array.isArray(record.plantAssignments.assignedPlants)) {\n            assignedPlants = record.plantAssignments.assignedPlants;\n            primaryPlant = record.plantAssignments.primaryPlant;\n          }\n        }\n        \n        // Check for assignedPlants directly from backend (comma-separated string)\n        if (assignedPlants.length === 0 && record.assignedPlants) {\n          if (Array.isArray(record.assignedPlants)) {\n            assignedPlants = record.assignedPlants;\n          } else if (typeof record.assignedPlants === 'string' && record.assignedPlants.trim()) {\n            // Parse comma-separated string\n            assignedPlants = record.assignedPlants.split(',').map(plant => plant.trim()).filter(Boolean);\n          }\n          primaryPlant = record.primaryPlant;\n        }\n        \n        if (!assignedPlants || assignedPlants.length === 0) {\n          return <span style={{ color: '#999' }} aria-label=\"No plants assigned\">None</span>;\n        }\n\n        const plants = assignedPlants\n          .map(plantCode => getPlantDescription(plantCode))\n          .join(', ');\n\n        return (\n          <div>\n            <div aria-label={`Assigned plants: ${plants}`}>{plants}</div>\n            {primaryPlant && (\n              <div \n                style={{ fontSize: '11px', color: '#666' }}\n                aria-label={`Primary plant: ${getPlantDescription(primaryPlant)}`}\n              >\n                Primary: {getPlantDescription(primaryPlant)}\n              </div>\n            )}\n          </div>\n        );\n      }\n    },\n    {\n      title: 'Actions',\n      key: 'actions',\n      'aria-label': 'Actions column',\n      render: (_, record) => (\n        <div role=\"group\" aria-label={`Actions for user ${record.username}`}>\n          <Button \n            type=\"link\" \n            icon={<EditOutlined />} \n            onClick={() => onEdit(record)}\n            aria-label={`Edit user ${record.username}`}\n            data-testid={`edit-button-${record.id}`}\n          >\n            Edit\n          </Button>\n          <Button\n            type=\"link\"\n            danger\n            icon={<DeleteOutlined />}\n            onClick={() => onDelete(record.id)}\n            aria-label={`Delete user ${record.username}`}\n            data-testid={`delete-button-${record.id}`}\n          >\n            Delete\n          </Button>\n        </div>\n      )\n    }\n  ], [onEdit, onDelete, getPlantDescription]);\n\n  // Memoized table props with safety checks\n  const tableProps = useMemo(() => {\n    // Ensure users is always an array\n    const safeUsers = Array.isArray(users) ? users : [];\n    \n    return {\n      columns,\n      dataSource: safeUsers,\n      rowKey: 'id', // Use user.id instead of array index for better performance\n      loading,\n      pagination: {\n        pageSize: 10,\n        showSizeChanger: true,\n        showQuickJumper: true,\n        showTotal: (total, range) => \n          `${range[0]}-${range[1]} of ${total} users`,\n        'aria-label': 'User table pagination'\n      },\n      scroll: { x: 800 }, // Enable horizontal scroll on small screens\n      size: 'middle',\n      'aria-label': 'Users table',\n      'data-testid': 'users-table'\n    };\n  }, [columns, users, loading]);\n\n  // Show empty state when no users\n  const safeUsers = Array.isArray(users) ? users : [];\n  if (!loading && safeUsers.length === 0) {\n    return (\n      <div \n        style={{ \n          textAlign: 'center', \n          padding: '40px 0', \n          color: '#999' \n        }}\n        role=\"status\"\n        aria-label=\"No users found\"\n      >\n        No users found. Click \"Add User\" to create the first user.\n      </div>\n    );\n  }\n\n  return (\n    <Table \n      {...tableProps}\n      locale={{\n        emptyText: 'No users found'\n      }}\n    />\n  );\n});\n\nUserTable.displayName = 'UserTable';\n\nUserTable.propTypes = {\n  users: PropTypes.array, // Made more flexible to handle null/undefined gracefully\n  loading: PropTypes.bool,\n  onEdit: PropTypes.func.isRequired,\n  onDelete: PropTypes.func.isRequired,\n  availablePlants: PropTypes.arrayOf(PropTypes.shape({\n    label: PropTypes.string.isRequired,\n    value: PropTypes.string.isRequired\n  }))\n};\n\nUserTable.defaultProps = {\n  users: [],\n  loading: false,\n  availablePlants: []\n};\n\nexport default UserTable;","import { message } from 'antd';\nimport { useReducer, useCallback, useEffect } from 'react';\n\nimport { userAPI } from '../services/userAPI';\nimport { ensureArray, safeApiResponse, safeRolesData, safePlantData } from '../utils/dataUtils';\n\n/**\n * @fileoverview Custom hook for managing user operations including CRUD operations,\n * state management, and error handling. Provides a centralized way to handle\n * user-related business logic with proper loading states and error handling.\n * \n * @author QRMFG Development Team\n * @since 1.0.0\n */\n\n// Simple API client mock for development\nconst createSimpleApiClient = () => {\n  if (process.env.NODE_ENV === 'test') {\n    return {\n      get: jest.fn(),\n      post: jest.fn(),\n      put: jest.fn(),\n      delete: jest.fn()\n    };\n  }\n  \n  // In production, import the real API client\n  try {\n    const apiClient = require('../api/client').default;\n    return apiClient;\n  } catch (error) {\n    console.warn('API client not available, using mock');\n    return {\n      get: () => Promise.resolve([]),\n      post: () => Promise.resolve({}),\n      put: () => Promise.resolve({}),\n      delete: () => Promise.resolve({})\n    };\n  }\n};\n\nconst apiClient = createSimpleApiClient();\n\n// Action types\nconst USER_ACTIONS = {\n  SET_LOADING: 'SET_LOADING',\n  SET_USERS: 'SET_USERS',\n  SET_ROLES: 'SET_ROLES',\n  SET_ERROR: 'SET_ERROR',\n  SET_MODAL_VISIBLE: 'SET_MODAL_VISIBLE',\n  SET_EDITING_USER: 'SET_EDITING_USER',\n  RESET_MODAL: 'RESET_MODAL'\n};\n\n// Initial state\nconst initialState = {\n  users: [],\n  roles: [],\n  loading: false,\n  error: null,\n  modalVisible: false,\n  editingUser: null\n};\n\n// Reducer function\nconst userReducer = (state, action) => {\n  switch (action.type) {\n    case USER_ACTIONS.SET_LOADING:\n      return { ...state, loading: action.payload };\n    case USER_ACTIONS.SET_USERS:\n      return { ...state, users: action.payload, loading: false, error: null };\n    case USER_ACTIONS.SET_ROLES:\n      return { ...state, roles: action.payload };\n    case USER_ACTIONS.SET_ERROR:\n      return { ...state, error: action.payload, loading: false };\n    case USER_ACTIONS.SET_MODAL_VISIBLE:\n      return { ...state, modalVisible: action.payload };\n    case USER_ACTIONS.SET_EDITING_USER:\n      return { ...state, editingUser: action.payload };\n    case USER_ACTIONS.RESET_MODAL:\n      return { ...state, modalVisible: false, editingUser: null };\n    default:\n      return state;\n  }\n};\n\n/**\n * Custom hook for comprehensive user management operations\n * \n * Provides a complete set of user management functionality including:\n * - User CRUD operations (Create, Read, Update, Delete)\n * - Plant assignment management\n * - Modal state management for user editing\n * - Loading states and error handling\n * - Automatic data fetching and caching\n * \n * @hook\n * @example\n * ```jsx\n * function UsersScreen() {\n *   const {\n *     users,\n *     loading,\n *     error,\n *     modalVisible,\n *     editingUser,\n *     actions\n *   } = useUserManagement();\n * \n *   useEffect(() => {\n *     actions.fetchUsers();\n *   }, [actions.fetchUsers]);\n * \n *   return (\n *     <div>\n *       <UserTable \n *         users={users}\n *         loading={loading}\n *         onEdit={actions.openEditModal}\n *         onDelete={actions.deleteUser}\n *       />\n *       <UserModal\n *         visible={modalVisible}\n *         editingUser={editingUser}\n *         onSave={actions.saveUser}\n *         onCancel={actions.closeModal}\n *       />\n *     </div>\n *   );\n * }\n * ```\n * \n * @returns {Object} User management state and actions\n * @returns {Array<Object>} returns.users - Array of user objects with plant assignments\n * @returns {boolean} returns.loading - Loading state for async operations\n * @returns {string|null} returns.error - Error message if any operation failed\n * @returns {boolean} returns.modalVisible - Whether the user edit modal is visible\n * @returns {Object|null} returns.editingUser - User object being edited (null for create mode)\n * @returns {Object} returns.actions - Object containing all available actions\n * @returns {Function} returns.actions.fetchUsers - Fetch all users from the server\n * @returns {Function} returns.actions.saveUser - Save user data (create or update)\n * @returns {Function} returns.actions.deleteUser - Delete a user by ID\n * @returns {Function} returns.actions.openEditModal - Open modal for editing a user\n * @returns {Function} returns.actions.openCreateModal - Open modal for creating a new user\n * @returns {Function} returns.actions.closeModal - Close the user edit/create modal\n * @returns {Function} returns.actions.assignPlantToUser - Assign a plant to a user\n * @returns {Function} returns.actions.removePlantFromUser - Remove plant assignment from user\n * \n * @since 1.0.0\n * @author QRMFG Development Team\n */\nexport const useUserManagement = () => {\n  const [state, dispatch] = useReducer(userReducer, initialState);\n\n  // Fetch users with plant assignments\n  const fetchUsers = useCallback(async (signal) => {\n    dispatch({ type: USER_ACTIONS.SET_LOADING, payload: true });\n    try {\n      const data = await apiClient.get('/admin/users', { signal });\n      // Safely extract users array from the response\n      const usersArray = safeApiResponse(data, 'users');\n\n      // Load plant assignments for each user\n      const usersWithPlants = await Promise.all(\n        usersArray.map(async (user) => {\n          try {\n            const plantData = await userAPI.getUserPlantAssignments(user.username, { signal });\n            return {\n              ...user,\n              roles: safeRolesData(user.roles),\n              plantAssignments: safePlantData(plantData)\n            };\n          } catch (error) {\n            if (!signal?.aborted) {\n              console.error('Error loading plant assignments:', error);\n            }\n            return {\n              ...user,\n              roles: safeRolesData(user.roles),\n              plantAssignments: safePlantData(null)\n            };\n          }\n        })\n      );\n\n      if (!signal?.aborted) {\n        dispatch({ type: USER_ACTIONS.SET_USERS, payload: usersWithPlants });\n      }\n    } catch (error) {\n      if (!signal?.aborted) {\n        console.error('Error fetching users:', error);\n        dispatch({ type: USER_ACTIONS.SET_ERROR, payload: error.message });\n        message.error('Failed to fetch users');\n        // Ensure we always set an empty array on error\n        dispatch({ type: USER_ACTIONS.SET_USERS, payload: [] });\n      }\n    }\n  }, []);\n\n  // Fetch roles\n  const fetchRoles = useCallback(async (signal) => {\n    try {\n      const data = await apiClient.get('/admin/roles', { signal });\n      if (!signal?.aborted) {\n        // Safely extract roles array from the response\n        const rolesArray = safeApiResponse(data, 'roles');\n        dispatch({ type: USER_ACTIONS.SET_ROLES, payload: rolesArray });\n      }\n    } catch (error) {\n      if (!signal?.aborted) {\n        console.error('Failed to fetch roles:', error);\n        message.error('Failed to fetch roles');\n        dispatch({ type: USER_ACTIONS.SET_ROLES, payload: [] });\n      }\n    }\n  }, []);\n\n  // Delete user\n  const deleteUser = useCallback(async (userId) => {\n    try {\n      await apiClient.delete(`/admin/users/${userId}`);\n      message.success('User deleted successfully');\n      // Refetch users after deletion\n      const controller = new AbortController();\n      await fetchUsers(controller.signal);\n    } catch (error) {\n      message.error('Failed to delete user');\n      throw error;\n    }\n  }, [fetchUsers]);\n\n  // Save user (create or update)\n  const saveUser = useCallback(async (values, editingUser) => {\n    try {\n      // Separate user data from plant data and roles\n      const { assignedPlants, primaryPlant, roles, ...userData } = values;\n\n      if (editingUser) {\n        // Update user basic info\n        await apiClient.put(`/admin/users/${editingUser.id}`, userData);\n\n        // Update roles if provided\n        if (roles && roles.length > 0) {\n          try {\n            await apiClient.post(`/admin/users/${editingUser.id}/roles`, {\n              roleIds: roles\n            });\n          } catch (roleError) {\n            console.warn('Failed to update user roles:', roleError);\n            message.warning('User updated but roles could not be assigned');\n          }\n        }\n\n        // Update plant assignments if provided\n        if (assignedPlants && assignedPlants.length > 0) {\n          await userAPI.updateUserPlantAssignments(editingUser.username, {\n            assignedPlants,\n            primaryPlant: primaryPlant || assignedPlants[0]\n          });\n        }\n\n        message.success('User updated successfully');\n      } else {\n        // Create new user with roles and plants included in the initial request\n        const userPayload = {\n          ...userData,\n          roles: roles || [],\n          assignedPlants: assignedPlants || [],\n          primaryPlant: primaryPlant || (assignedPlants && assignedPlants.length > 0 ? assignedPlants[0] : null)\n        };\n        \n        const response = await apiClient.post('/admin/users', userPayload);\n        console.log('User creation response:', response);\n        \n        // Check if the response indicates any warnings (like role assignment failures)\n        if (response.status === 'warning') {\n          message.warning(response.message);\n        } else if (response.status === 'success') {\n          message.success('User created successfully');\n        } else {\n          message.success('User created successfully');\n        }\n\n\n      }\n\n      dispatch({ type: USER_ACTIONS.RESET_MODAL });\n      // Refetch users after save\n      const controller = new AbortController();\n      await fetchUsers(controller.signal);\n    } catch (error) {\n      message.error('Failed to save user');\n      throw error;\n    }\n  }, [fetchUsers]);\n\n  // Open edit modal\n  const openEditModal = useCallback(async (user) => {\n    dispatch({ type: USER_ACTIONS.SET_EDITING_USER, payload: user });\n    dispatch({ type: USER_ACTIONS.SET_MODAL_VISIBLE, payload: true });\n  }, []);\n\n  // Open add modal\n  const openAddModal = useCallback(() => {\n    dispatch({ type: USER_ACTIONS.SET_EDITING_USER, payload: null });\n    dispatch({ type: USER_ACTIONS.SET_MODAL_VISIBLE, payload: true });\n  }, []);\n\n  // Close modal\n  const closeModal = useCallback(() => {\n    dispatch({ type: USER_ACTIONS.RESET_MODAL });\n  }, []);\n\n  // Initialize data on mount\n  useEffect(() => {\n    const controller = new AbortController();\n\n    const initializeData = async () => {\n      try {\n        await Promise.all([\n          fetchUsers(controller.signal),\n          fetchRoles(controller.signal)\n        ]);\n      } catch (error) {\n        if (!controller.signal.aborted) {\n          console.error('Error initializing user management data:', error);\n        }\n      }\n    };\n\n    initializeData();\n\n    return () => {\n      controller.abort();\n    };\n  }, [fetchUsers, fetchRoles]);\n\n  // Memoized actions object\n  const actions = {\n    fetchUsers,\n    fetchRoles,\n    deleteUser,\n    saveUser,\n    openEditModal,\n    openAddModal,\n    closeModal\n  };\n\n  return {\n    ...state,\n    actions\n  };\n};","import { Button, Space, message, Alert } from 'antd';\nimport React, { useCallback } from 'react';\n\nimport UserErrorBoundary from '../components/ErrorBoundaries/UserErrorBoundary';\nimport UserModal from '../components/User/UserModal';\nimport UserTable from '../components/User/UserTable';\nimport { usePlantAssignment } from '../hooks/usePlantAssignment';\nimport { useUserManagement } from '../hooks/useUserManagement';\nimport { getCurrentUser, isAuthenticated, getUserRoles } from '../services/auth';\nimport { masterDataAPI } from '../services/masterDataAPI';\nconst Users = () => {\n  // Use custom hooks for state management\n  const { users, roles, loading, modalVisible, editingUser, actions } = useUserManagement();\n  const { availablePlants } = usePlantAssignment();\n\n  // Handle test API calls (keeping existing functionality)\n  const handleTestLocationAPI = useCallback(async () => {\n    try {\n      const result = await masterDataAPI.testLocationMaster();\n      message.success(result);\n    } catch (error) {\n      message.error(`Test failed: ${  error.message}`);\n    }\n  }, []);\n\n  const handleTestSimpleAPI = useCallback(async () => {\n    try {\n      const result = await masterDataAPI.testSimpleLocation();\n      message.success(result);\n    } catch (error) {\n      message.error(`Simple test failed: ${  error.message}`);\n    }\n  }, []);\n\n  const handleDiagnosticAPI = useCallback(async () => {\n    try {\n      const result = await masterDataAPI.diagnosticLocationMaster();\n      console.log('Diagnostic result:', result);\n      message.info('Check console for diagnostic info');\n    } catch (error) {\n      message.error(`Diagnostic failed: ${  error.message}`);\n    }\n  }, []);\n\n  // Handle retry for error boundary\n  const handleRetry = useCallback(() => {\n    const controller = new AbortController();\n    actions.fetchUsers(controller.signal);\n  }, [actions]);\n\n  // Test user roles endpoint\n  const handleTestUserRoles = useCallback(async () => {\n    try {\n      // Import the API client\n      const apiClient = (await import('../api/client')).default;\n      const result = await apiClient.get('/admin/test/user-roles');\n      console.log('Test user roles result:', result);\n      message.success('Test successful! Check console for user roles test data');\n    } catch (error) {\n      console.error('Test user roles failed:', error);\n      if (error.status === 401) {\n        message.error('Authentication failed. Please log in first.');\n      } else {\n        message.error(`Test failed: ${error.message}`);\n      }\n    }\n  }, []);\n\n  // Quick login redirect\n  const handleGoToLogin = useCallback(() => {\n    window.location.href = '/qrmfg/login';\n  }, []);\n\n  // Fix admin roles\n  const handleFixAdminRoles = useCallback(async () => {\n    try {\n      const apiClient = (await import('../api/client')).default;\n      const result = await apiClient.post('/admin/fix-admin-roles');\n      console.log('Fix admin roles result:', result);\n      message.success('Admin roles fixed! Refreshing user data...');\n      // Refresh the users data\n      const controller = new AbortController();\n      actions.fetchUsers(controller.signal);\n    } catch (error) {\n      console.error('Fix admin roles failed:', error);\n      message.error(`Fix failed: ${error.message}`);\n    }\n  }, [actions]);\n\n  // Get current user info for debugging\n  const currentUser = getCurrentUser();\n  const userRoles = getUserRoles();\n  const authenticated = isAuthenticated();\n\n  return (\n    <UserErrorBoundary context=\"user-management\" onRetry={handleRetry}>\n      <div style={{ padding: '24px' }}>\n        {/* Debug info */}\n        <Alert\n          message={`Debug Info: User: ${currentUser || 'Not logged in'}, Authenticated: ${authenticated}, Roles: ${userRoles.join(', ') || 'None'}`}\n          type={authenticated ? \"info\" : \"warning\"}\n          style={{ marginBottom: 16 }}\n          showIcon\n          action={\n            !authenticated && (\n              <Button size=\"small\" onClick={handleGoToLogin}>\n                Go to Login\n              </Button>\n            )\n          }\n        />\n\n        {/* Action buttons */}\n        <div style={{ marginBottom: 16 }}>\n          <Space wrap>\n            <Button \n              type=\"primary\" \n              onClick={actions.openAddModal}\n              data-testid=\"add-user-button\"\n            >\n              Add User\n            </Button>\n            <Button onClick={handleTestLocationAPI}>\n              Test Location API\n            </Button>\n            <Button onClick={handleTestSimpleAPI}>\n              Test Simple API\n            </Button>\n            <Button onClick={handleDiagnosticAPI}>\n              Diagnostic\n            </Button>\n            <Button onClick={handleTestUserRoles}>\n              Test User Roles\n            </Button>\n            <Button onClick={handleFixAdminRoles} type=\"dashed\">\n              Fix Admin Roles\n            </Button>\n          </Space>\n        </div>\n\n        {/* Users table */}\n        <UserTable\n          users={users}\n          loading={loading}\n          onEdit={actions.openEditModal}\n          onDelete={actions.deleteUser}\n          availablePlants={availablePlants}\n        />\n\n        {/* User modal */}\n        <UserModal\n          visible={modalVisible}\n          editingUser={editingUser}\n          roles={roles}\n          onSave={actions.saveUser}\n          onCancel={actions.closeModal}\n          loading={loading}\n        />\n      </div>\n    </UserErrorBoundary>\n  );\n};\n\nexport default Users;\n","/**\n * SecureForm Component\n * \n * A wrapper component that provides enhanced security features for forms including:\n * - Input validation and sanitization\n * - XSS prevention\n * - Security audit logging\n * - Real-time validation feedback\n * \n * @component\n * @since 1.0.0\n * @author QRMFG Security Team\n */\n\nimport { Form, Input, message } from 'antd';\nimport PropTypes from 'prop-types';\nimport React, { useCallback, useEffect, useState } from 'react';\n\nimport { \n  InputSanitizer, \n  ValidationRules, \n  useInputValidation, \n  SecurityAuditLogger \n} from '../utils/inputValidation';\n\nconst { TextArea } = Input;\n\n/**\n * SecureInput Component - Enhanced input with validation and sanitization\n */\nconst SecureInput = React.memo(({ \n  value, \n  onChange, \n  validationType = 'text',\n  componentName = 'SecureInput',\n  fieldName = 'input',\n  onValidationChange,\n  ...props \n}) => {\n  const { validateInput } = useInputValidation();\n  const [validationState, setValidationState] = useState({\n    isValid: true,\n    errors: [],\n    wasModified: false\n  });\n\n  const handleChange = useCallback((e) => {\n    const inputValue = e.target.value;\n    const validation = validateInput(inputValue, validationType);\n    \n    setValidationState(validation);\n    \n    // Log potential security issues\n    if (validation.wasModified) {\n      SecurityAuditLogger.logXSSAttempt(\n        inputValue,\n        validation.sanitizedValue,\n        componentName,\n        fieldName\n      );\n      \n      message.warning('Input was sanitized for security reasons');\n    }\n    \n    // Call parent onChange with sanitized value\n    if (onChange) {\n      onChange({\n        ...e,\n        target: {\n          ...e.target,\n          value: validation.sanitizedValue\n        }\n      });\n    }\n    \n    // Notify parent of validation state\n    if (onValidationChange) {\n      onValidationChange(validation);\n    }\n  }, [onChange, validationType, componentName, fieldName, onValidationChange, validateInput]);\n\n  return (\n    <Input\n      {...props}\n      value={value}\n      onChange={handleChange}\n      status={validationState.isValid ? '' : 'error'}\n      title={validationState.errors.join(', ')}\n    />\n  );\n});\n\n/**\n * SecureTextArea Component - Enhanced textarea with validation and sanitization\n */\nconst SecureTextArea = React.memo(({ \n  value, \n  onChange, \n  validationType = 'richtext',\n  componentName = 'SecureTextArea',\n  fieldName = 'textarea',\n  onValidationChange,\n  ...props \n}) => {\n  const { validateInput } = useInputValidation();\n  const [validationState, setValidationState] = useState({\n    isValid: true,\n    errors: [],\n    wasModified: false\n  });\n\n  const handleChange = useCallback((e) => {\n    const inputValue = e.target.value;\n    const validation = validateInput(inputValue, validationType);\n    \n    setValidationState(validation);\n    \n    // Log potential security issues\n    if (validation.wasModified) {\n      SecurityAuditLogger.logXSSAttempt(\n        inputValue,\n        validation.sanitizedValue,\n        componentName,\n        fieldName\n      );\n      \n      message.warning('Input was sanitized for security reasons');\n    }\n    \n    // Call parent onChange with sanitized value\n    if (onChange) {\n      onChange({\n        ...e,\n        target: {\n          ...e.target,\n          value: validation.sanitizedValue\n        }\n      });\n    }\n    \n    // Notify parent of validation state\n    if (onValidationChange) {\n      onValidationChange(validation);\n    }\n  }, [onChange, validationType, componentName, fieldName, onValidationChange, validateInput]);\n\n  return (\n    <TextArea\n      {...props}\n      value={value}\n      onChange={handleChange}\n      status={validationState.isValid ? '' : 'error'}\n      title={validationState.errors.join(', ')}\n    />\n  );\n});\n\n/**\n * SecureForm Component - Enhanced form with security features\n */\nconst SecureForm = React.memo(({ \n  children, \n  onFinish, \n  componentName = 'SecureForm',\n  enableSecurityLogging = true,\n  ...props \n}) => {\n  const [securityEvents, setSecurityEvents] = useState([]);\n\n  // Handle form submission with security validation\n  const handleFinish = useCallback(async (values) => {\n    try {\n      // Sanitize all form values before submission\n      const sanitizedValues = {};\n      const securityIssues = [];\n\n      Object.keys(values).forEach(key => {\n        const originalValue = values[key];\n        \n        if (typeof originalValue === 'string') {\n          const sanitizedValue = InputSanitizer.sanitizeText(originalValue);\n          sanitizedValues[key] = sanitizedValue;\n          \n          if (sanitizedValue !== originalValue) {\n            securityIssues.push({\n              field: key,\n              originalValue: originalValue.substring(0, 50),\n              sanitizedValue: sanitizedValue.substring(0, 50)\n            });\n          }\n        } else {\n          sanitizedValues[key] = originalValue;\n        }\n      });\n\n      // Log security issues if any\n      if (securityIssues.length > 0 && enableSecurityLogging) {\n        securityIssues.forEach(issue => {\n          SecurityAuditLogger.logXSSAttempt(\n            issue.originalValue,\n            issue.sanitizedValue,\n            componentName,\n            issue.field\n          );\n        });\n        \n        message.warning(`${securityIssues.length} field(s) were sanitized for security`);\n      }\n\n      // Call original onFinish with sanitized values\n      if (onFinish) {\n        await onFinish(sanitizedValues);\n      }\n    } catch (error) {\n      console.error('SecureForm submission error:', error);\n      message.error('Form submission failed');\n      throw error;\n    }\n  }, [onFinish, componentName, enableSecurityLogging]);\n\n  // Track security events\n  useEffect(() => {\n    if (enableSecurityLogging) {\n      const events = SecurityAuditLogger.getRecentEvents();\n      setSecurityEvents(events.slice(-10)); // Keep last 10 events\n    }\n  }, [enableSecurityLogging]);\n\n  return (\n    <Form\n      {...props}\n      onFinish={handleFinish}\n      validateTrigger={['onChange', 'onBlur']}\n    >\n      {children}\n      \n      {/* Development mode security info */}\n      {process.env.NODE_ENV === 'development' && securityEvents.length > 0 && (\n        <div style={{ \n          marginTop: 16, \n          padding: 8, \n          background: '#fff7e6', \n          border: '1px solid #ffd591',\n          borderRadius: 4,\n          fontSize: 12\n        }}>\n          <strong>Security Events (Dev Mode):</strong>\n          <ul style={{ margin: '4px 0', paddingLeft: 16 }}>\n            {securityEvents.slice(-3).map((event, index) => (\n              <li key={index}>\n                {event.type} in {event.component}.{event.field} at {new Date(event.timestamp).toLocaleTimeString()}\n              </li>\n            ))}\n          </ul>\n        </div>\n      )}\n    </Form>\n  );\n});\n\n// Form.Item wrapper with enhanced validation\nconst SecureFormItem = React.memo(({ \n  children, \n  validationType = 'text',\n  name,\n  rules = [],\n  ...props \n}) => {\n  // Combine custom rules with security validation rules\n  const securityRules = React.useMemo(() => {\n    let baseRules = [];\n    \n    switch (validationType) {\n      case 'username':\n        baseRules = ValidationRules.username;\n        break;\n      case 'email':\n        baseRules = ValidationRules.email;\n        break;\n      case 'password':\n        baseRules = ValidationRules.password;\n        break;\n      case 'projectCode':\n        baseRules = ValidationRules.projectCode;\n        break;\n      case 'materialCode':\n        baseRules = ValidationRules.materialCode;\n        break;\n      case 'plantCode':\n        baseRules = ValidationRules.plantCode;\n        break;\n      case 'text':\n        baseRules = ValidationRules.text(false, 0, 255);\n        break;\n      case 'richtext':\n        baseRules = ValidationRules.richText(false, 0, 1000);\n        break;\n      default:\n        baseRules = [];\n    }\n    \n    return [...baseRules, ...rules];\n  }, [validationType, rules]);\n\n  return (\n    <Form.Item\n      {...props}\n      name={name}\n      rules={securityRules}\n    >\n      {children}\n    </Form.Item>\n  );\n});\n\n// PropTypes\nSecureInput.propTypes = {\n  value: PropTypes.string,\n  onChange: PropTypes.func,\n  validationType: PropTypes.oneOf(['text', 'username', 'email', 'sql', 'filename', 'url']),\n  componentName: PropTypes.string,\n  fieldName: PropTypes.string,\n  onValidationChange: PropTypes.func\n};\n\nSecureTextArea.propTypes = {\n  value: PropTypes.string,\n  onChange: PropTypes.func,\n  validationType: PropTypes.oneOf(['text', 'richtext']),\n  componentName: PropTypes.string,\n  fieldName: PropTypes.string,\n  onValidationChange: PropTypes.func\n};\n\nSecureForm.propTypes = {\n  children: PropTypes.node.isRequired,\n  onFinish: PropTypes.func,\n  componentName: PropTypes.string,\n  enableSecurityLogging: PropTypes.bool\n};\n\nSecureFormItem.propTypes = {\n  children: PropTypes.node.isRequired,\n  validationType: PropTypes.string,\n  name: PropTypes.string,\n  rules: PropTypes.array\n};\n\n// Display names\nSecureInput.displayName = 'SecureInput';\nSecureTextArea.displayName = 'SecureTextArea';\nSecureForm.displayName = 'SecureForm';\nSecureFormItem.displayName = 'SecureFormItem';\n\n// Exports\nexport { SecureInput, SecureTextArea, SecureFormItem };\nexport default SecureForm;","import { unit } from '@ant-design/cssinjs';\nimport { FastColor } from '@ant-design/fast-color';\nimport { resetComponent } from '../../style';\nimport { genStyleHooks, mergeToken } from '../../theme/internal';\n// ============================== Styles ==============================\nconst genBaseStyle = token => {\n  const {\n    paddingXXS,\n    lineWidth,\n    tagPaddingHorizontal,\n    componentCls,\n    calc\n  } = token;\n  const paddingInline = calc(tagPaddingHorizontal).sub(lineWidth).equal();\n  const iconMarginInline = calc(paddingXXS).sub(lineWidth).equal();\n  return {\n    // Result\n    [componentCls]: Object.assign(Object.assign({}, resetComponent(token)), {\n      display: 'inline-block',\n      height: 'auto',\n      // https://github.com/ant-design/ant-design/pull/47504\n      marginInlineEnd: token.marginXS,\n      paddingInline,\n      fontSize: token.tagFontSize,\n      lineHeight: token.tagLineHeight,\n      whiteSpace: 'nowrap',\n      background: token.defaultBg,\n      border: `${unit(token.lineWidth)} ${token.lineType} ${token.colorBorder}`,\n      borderRadius: token.borderRadiusSM,\n      opacity: 1,\n      transition: `all ${token.motionDurationMid}`,\n      textAlign: 'start',\n      position: 'relative',\n      // RTL\n      [`&${componentCls}-rtl`]: {\n        direction: 'rtl'\n      },\n      '&, a, a:hover': {\n        color: token.defaultColor\n      },\n      [`${componentCls}-close-icon`]: {\n        marginInlineStart: iconMarginInline,\n        fontSize: token.tagIconSize,\n        color: token.colorIcon,\n        cursor: 'pointer',\n        transition: `all ${token.motionDurationMid}`,\n        '&:hover': {\n          color: token.colorTextHeading\n        }\n      },\n      [`&${componentCls}-has-color`]: {\n        borderColor: 'transparent',\n        [`&, a, a:hover, ${token.iconCls}-close, ${token.iconCls}-close:hover`]: {\n          color: token.colorTextLightSolid\n        }\n      },\n      '&-checkable': {\n        backgroundColor: 'transparent',\n        borderColor: 'transparent',\n        cursor: 'pointer',\n        [`&:not(${componentCls}-checkable-checked):hover`]: {\n          color: token.colorPrimary,\n          backgroundColor: token.colorFillSecondary\n        },\n        '&:active, &-checked': {\n          color: token.colorTextLightSolid\n        },\n        '&-checked': {\n          backgroundColor: token.colorPrimary,\n          '&:hover': {\n            backgroundColor: token.colorPrimaryHover\n          }\n        },\n        '&:active': {\n          backgroundColor: token.colorPrimaryActive\n        }\n      },\n      '&-hidden': {\n        display: 'none'\n      },\n      // To ensure that a space will be placed between character and `Icon`.\n      [`> ${token.iconCls} + span, > span + ${token.iconCls}`]: {\n        marginInlineStart: paddingInline\n      }\n    }),\n    [`${componentCls}-borderless`]: {\n      borderColor: 'transparent',\n      background: token.tagBorderlessBg\n    }\n  };\n};\n// ============================== Export ==============================\nexport const prepareToken = token => {\n  const {\n    lineWidth,\n    fontSizeIcon,\n    calc\n  } = token;\n  const tagFontSize = token.fontSizeSM;\n  const tagToken = mergeToken(token, {\n    tagFontSize,\n    tagLineHeight: unit(calc(token.lineHeightSM).mul(tagFontSize).equal()),\n    tagIconSize: calc(fontSizeIcon).sub(calc(lineWidth).mul(2)).equal(),\n    // Tag icon is much smaller\n    tagPaddingHorizontal: 8,\n    // Fixed padding.\n    tagBorderlessBg: token.defaultBg\n  });\n  return tagToken;\n};\nexport const prepareComponentToken = token => ({\n  defaultBg: new FastColor(token.colorFillQuaternary).onBackground(token.colorBgContainer).toHexString(),\n  defaultColor: token.colorText\n});\nexport default genStyleHooks('Tag', token => {\n  const tagToken = prepareToken(token);\n  return genBaseStyle(tagToken);\n}, prepareComponentToken);","\"use client\";\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\nimport * as React from 'react';\nimport classNames from 'classnames';\nimport { ConfigContext } from '../config-provider';\nimport useStyle from './style';\nconst CheckableTag = /*#__PURE__*/React.forwardRef((props, ref) => {\n  const {\n      prefixCls: customizePrefixCls,\n      style,\n      className,\n      checked,\n      onChange,\n      onClick\n    } = props,\n    restProps = __rest(props, [\"prefixCls\", \"style\", \"className\", \"checked\", \"onChange\", \"onClick\"]);\n  const {\n    getPrefixCls,\n    tag\n  } = React.useContext(ConfigContext);\n  const handleClick = e => {\n    onChange === null || onChange === void 0 ? void 0 : onChange(!checked);\n    onClick === null || onClick === void 0 ? void 0 : onClick(e);\n  };\n  const prefixCls = getPrefixCls('tag', customizePrefixCls);\n  // Style\n  const [wrapCSSVar, hashId, cssVarCls] = useStyle(prefixCls);\n  const cls = classNames(prefixCls, `${prefixCls}-checkable`, {\n    [`${prefixCls}-checkable-checked`]: checked\n  }, tag === null || tag === void 0 ? void 0 : tag.className, className, hashId, cssVarCls);\n  return wrapCSSVar(/*#__PURE__*/React.createElement(\"span\", Object.assign({}, restProps, {\n    ref: ref,\n    style: Object.assign(Object.assign({}, style), tag === null || tag === void 0 ? void 0 : tag.style),\n    className: cls,\n    onClick: handleClick\n  })));\n});\nexport default CheckableTag;","// Style as status component\nimport { prepareComponentToken, prepareToken } from '.';\nimport { genPresetColor, genSubStyleComponent } from '../../theme/internal';\n// ============================== Preset ==============================\nconst genPresetStyle = token => genPresetColor(token, (colorKey, {\n  textColor,\n  lightBorderColor,\n  lightColor,\n  darkColor\n}) => ({\n  [`${token.componentCls}${token.componentCls}-${colorKey}`]: {\n    color: textColor,\n    background: lightColor,\n    borderColor: lightBorderColor,\n    // Inverse color\n    '&-inverse': {\n      color: token.colorTextLightSolid,\n      background: darkColor,\n      borderColor: darkColor\n    },\n    [`&${token.componentCls}-borderless`]: {\n      borderColor: 'transparent'\n    }\n  }\n}));\n// ============================== Export ==============================\nexport default genSubStyleComponent(['Tag', 'preset'], token => {\n  const tagToken = prepareToken(token);\n  return genPresetStyle(tagToken);\n}, prepareComponentToken);","import { prepareComponentToken, prepareToken } from '.';\nimport capitalize from '../../_util/capitalize';\nimport { genSubStyleComponent } from '../../theme/internal';\nconst genTagStatusStyle = (token, status, cssVariableType) => {\n  const capitalizedCssVariableType = capitalize(cssVariableType);\n  return {\n    [`${token.componentCls}${token.componentCls}-${status}`]: {\n      color: token[`color${cssVariableType}`],\n      background: token[`color${capitalizedCssVariableType}Bg`],\n      borderColor: token[`color${capitalizedCssVariableType}Border`],\n      [`&${token.componentCls}-borderless`]: {\n        borderColor: 'transparent'\n      }\n    }\n  };\n};\n// ============================== Export ==============================\nexport default genSubStyleComponent(['Tag', 'status'], token => {\n  const tagToken = prepareToken(token);\n  return [genTagStatusStyle(tagToken, 'success', 'Success'), genTagStatusStyle(tagToken, 'processing', 'Info'), genTagStatusStyle(tagToken, 'error', 'Error'), genTagStatusStyle(tagToken, 'warning', 'Warning')];\n}, prepareComponentToken);","export default function capitalize(str) {\n  if (typeof str !== 'string') {\n    return str;\n  }\n  const ret = str.charAt(0).toUpperCase() + str.slice(1);\n  return ret;\n}","\"use client\";\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\nimport * as React from 'react';\nimport classNames from 'classnames';\nimport omit from \"rc-util/es/omit\";\nimport { isPresetColor, isPresetStatusColor } from '../_util/colors';\nimport useClosable, { pickClosable } from '../_util/hooks/useClosable';\nimport { replaceElement } from '../_util/reactNode';\nimport { devUseWarning } from '../_util/warning';\nimport Wave from '../_util/wave';\nimport { ConfigContext } from '../config-provider';\nimport CheckableTag from './CheckableTag';\nimport useStyle from './style';\nimport PresetCmp from './style/presetCmp';\nimport StatusCmp from './style/statusCmp';\nconst InternalTag = /*#__PURE__*/React.forwardRef((tagProps, ref) => {\n  const {\n      prefixCls: customizePrefixCls,\n      className,\n      rootClassName,\n      style,\n      children,\n      icon,\n      color,\n      onClose,\n      bordered = true,\n      visible: deprecatedVisible\n    } = tagProps,\n    props = __rest(tagProps, [\"prefixCls\", \"className\", \"rootClassName\", \"style\", \"children\", \"icon\", \"color\", \"onClose\", \"bordered\", \"visible\"]);\n  const {\n    getPrefixCls,\n    direction,\n    tag: tagContext\n  } = React.useContext(ConfigContext);\n  const [visible, setVisible] = React.useState(true);\n  const domProps = omit(props, ['closeIcon', 'closable']);\n  // Warning for deprecated usage\n  if (process.env.NODE_ENV !== 'production') {\n    const warning = devUseWarning('Tag');\n    warning.deprecated(!('visible' in tagProps), 'visible', 'visible && <Tag />');\n  }\n  React.useEffect(() => {\n    if (deprecatedVisible !== undefined) {\n      setVisible(deprecatedVisible);\n    }\n  }, [deprecatedVisible]);\n  const isPreset = isPresetColor(color);\n  const isStatus = isPresetStatusColor(color);\n  const isInternalColor = isPreset || isStatus;\n  const tagStyle = Object.assign(Object.assign({\n    backgroundColor: color && !isInternalColor ? color : undefined\n  }, tagContext === null || tagContext === void 0 ? void 0 : tagContext.style), style);\n  const prefixCls = getPrefixCls('tag', customizePrefixCls);\n  const [wrapCSSVar, hashId, cssVarCls] = useStyle(prefixCls);\n  // Style\n  const tagClassName = classNames(prefixCls, tagContext === null || tagContext === void 0 ? void 0 : tagContext.className, {\n    [`${prefixCls}-${color}`]: isInternalColor,\n    [`${prefixCls}-has-color`]: color && !isInternalColor,\n    [`${prefixCls}-hidden`]: !visible,\n    [`${prefixCls}-rtl`]: direction === 'rtl',\n    [`${prefixCls}-borderless`]: !bordered\n  }, className, rootClassName, hashId, cssVarCls);\n  const handleCloseClick = e => {\n    e.stopPropagation();\n    onClose === null || onClose === void 0 ? void 0 : onClose(e);\n    if (e.defaultPrevented) {\n      return;\n    }\n    setVisible(false);\n  };\n  const [, mergedCloseIcon] = useClosable(pickClosable(tagProps), pickClosable(tagContext), {\n    closable: false,\n    closeIconRender: iconNode => {\n      const replacement = /*#__PURE__*/React.createElement(\"span\", {\n        className: `${prefixCls}-close-icon`,\n        onClick: handleCloseClick\n      }, iconNode);\n      return replaceElement(iconNode, replacement, originProps => ({\n        onClick: e => {\n          var _a;\n          (_a = originProps === null || originProps === void 0 ? void 0 : originProps.onClick) === null || _a === void 0 ? void 0 : _a.call(originProps, e);\n          handleCloseClick(e);\n        },\n        className: classNames(originProps === null || originProps === void 0 ? void 0 : originProps.className, `${prefixCls}-close-icon`)\n      }));\n    }\n  });\n  const isNeedWave = typeof props.onClick === 'function' || children && children.type === 'a';\n  const iconNode = icon || null;\n  const kids = iconNode ? (/*#__PURE__*/React.createElement(React.Fragment, null, iconNode, children && /*#__PURE__*/React.createElement(\"span\", null, children))) : children;\n  const tagNode = /*#__PURE__*/React.createElement(\"span\", Object.assign({}, domProps, {\n    ref: ref,\n    className: tagClassName,\n    style: tagStyle\n  }), kids, mergedCloseIcon, isPreset && /*#__PURE__*/React.createElement(PresetCmp, {\n    key: \"preset\",\n    prefixCls: prefixCls\n  }), isStatus && /*#__PURE__*/React.createElement(StatusCmp, {\n    key: \"status\",\n    prefixCls: prefixCls\n  }));\n  return wrapCSSVar(isNeedWave ? /*#__PURE__*/React.createElement(Wave, {\n    component: \"Tag\"\n  }, tagNode) : tagNode);\n});\nconst Tag = InternalTag;\nif (process.env.NODE_ENV !== 'production') {\n  Tag.displayName = 'Tag';\n}\nTag.CheckableTag = CheckableTag;\nexport default Tag;","import apiClient from '../api/client';\nimport { getToken, isAuthenticated } from '../services/auth';\n\n/**\n * User API service providing user management functionality\n * Migrated to use unified APIClient with standardized error handling\n *\n * @namespace userAPI\n */\nexport const userAPI = {\n  /**\n   * Get current user's plant assignments from backend API\n   * @param {string} username - Username to get plant assignments for\n   * @param {Object} options - Additional options including signal for AbortController\n   * @returns {Promise<Object>} Plant assignment data\n   */\n  getUserPlantAssignments: async (username, options = {}) => {\n    try {\n      console.log('Getting plant assignments for user:', username);\n      console.log('Is authenticated:', isAuthenticated());\n\n      // Check if user is authenticated first\n      if (!isAuthenticated()) {\n        console.warn('User is not authenticated, cannot get plant assignments');\n        return {\n          assignedPlants: [],\n          primaryPlant: null,\n          effectivePlant: null,\n          isPlantUser: false\n        };\n      }\n\n      // Primary method: Get plant info from JWT token validation\n      const token = getToken();\n      console.log('Retrieved token:', token ? 'Token found' : 'No token found');\n\n      if (token) {\n        try {\n          const validationResponse = await apiClient.post('/auth/validate', { token }, options);\n          console.log('Token validation response:', validationResponse);\n          console.log('Plant codes in token:', validationResponse.plantCodes);\n          console.log('Primary plant in token:', validationResponse.primaryPlant);\n          console.log('Is plant user:', validationResponse.isPlantUser);\n\n          if (validationResponse.valid) {\n            // Check if we have plant data in the token\n            if (validationResponse.plantCodes && validationResponse.plantCodes.length > 0) {\n              console.log('Plant assignments from token:', validationResponse);\n              return {\n                assignedPlants: validationResponse.plantCodes || [],\n                primaryPlant: validationResponse.primaryPlant || null,\n                effectivePlant: validationResponse.primaryPlant || (validationResponse.plantCodes && validationResponse.plantCodes[0]) || null,\n                isPlantUser: validationResponse.isPlantUser || false\n              };\n            }\n\n            // Handle case where user has primaryPlant but empty plantCodes array\n            if (validationResponse.primaryPlant && validationResponse.isPlantUser) {\n              console.log('User has primary plant but empty plantCodes, using primary plant as assigned plant:', validationResponse.primaryPlant);\n              return {\n                assignedPlants: [validationResponse.primaryPlant],\n                primaryPlant: validationResponse.primaryPlant,\n                effectivePlant: validationResponse.primaryPlant,\n                isPlantUser: validationResponse.isPlantUser || false\n              };\n            }\n\n            // If no plant data in token but token is valid, user might not have plants assigned\n            console.log('Token is valid but no plant data found in token');\n          }\n        } catch (tokenError) {\n          console.warn('Failed to validate token for plant assignments:', tokenError);\n        }\n      }\n\n      // Fallback: try to get from stored user data (check multiple storage keys)\n      const possibleKeys = ['userData', 'qrmfg_user_data', 'user_info'];\n      for (const key of possibleKeys) {\n        const storedUserData = localStorage.getItem(key) || sessionStorage.getItem(key);\n        if (storedUserData) {\n          try {\n            const userData = JSON.parse(storedUserData);\n            if (userData.plantCodes || userData.assignedPlants) {\n              console.log('Plant assignments from stored data:', userData);\n              return {\n                assignedPlants: userData.plantCodes || userData.assignedPlants || [],\n                primaryPlant: userData.primaryPlant || null,\n                effectivePlant: userData.primaryPlant || ((userData.plantCodes || userData.assignedPlants) && (userData.plantCodes || userData.assignedPlants)[0]) || null,\n                isPlantUser: userData.isPlantUser || false\n              };\n            }\n          } catch (parseError) {\n            console.warn(`Failed to parse stored user data from ${key}:`, parseError);\n          }\n        }\n      }\n\n      // Last resort: Try admin endpoints only if user might have admin access\n      try {\n        // Only try admin endpoints if we think the user might be an admin\n        const adminToken = getToken();\n        const validationResponse = await apiClient.post('/auth/validate', { token: adminToken }, options);\n        if (validationResponse.valid && validationResponse.isAdmin) {\n          console.log('User appears to be admin, trying admin endpoints...');\n\n          const userDetails = await apiClient.get('/admin/users', options);\n          const currentUser = userDetails.users?.find(user => user.username === username);\n\n          if (currentUser && currentUser.assignedPlants) {\n            console.log('Admin endpoint: Using user details for plant assignments:', currentUser);\n\n            return {\n              assignedPlants: currentUser.assignedPlants || [],\n              primaryPlant: currentUser.primaryPlant || null,\n              effectivePlant: currentUser.primaryPlant || (currentUser.assignedPlants && currentUser.assignedPlants[0]) || null,\n              isPlantUser: (currentUser.assignedPlants && currentUser.assignedPlants.length > 0) || false\n            };\n          }\n        }\n      } catch (adminError) {\n        console.warn('Admin endpoints not accessible (expected for non-admin users):', adminError.message);\n      }\n\n      // If no plant data available, return empty structure\n      console.warn('No plant assignment data available for user:', username);\n      return {\n        assignedPlants: [],\n        primaryPlant: null,\n        effectivePlant: null,\n        isPlantUser: false\n      };\n    } catch (error) {\n      console.error('Error getting user plant assignments:', error);\n      // Return empty structure on error to prevent crashes\n      return {\n        assignedPlants: [],\n        primaryPlant: null,\n        effectivePlant: null,\n        isPlantUser: false\n      };\n    }\n  },\n\n  /**\n   * Update user's plant assignments\n   * @param {string} username - Username to update plant assignments for\n   * @param {Object} plantData - Plant assignment data\n   * @returns {Promise<Object>} Updated plant assignments\n   */\n  updateUserPlantAssignments: (username, plantData) =>\n    apiClient.put(`/admin/users/${encodeURIComponent(username)}/plants`, plantData),\n\n  /**\n   * Check if user is assigned to a specific plant\n   * @param {string} username - Username to check\n   * @param {string} plantCode - Plant code to check assignment for\n   * @returns {Promise<boolean>} True if user is assigned to plant\n   */\n  checkUserPlantAssignment: (username, plantCode) =>\n    apiClient.get(\n      `/admin/users/${encodeURIComponent(username)}/plants/${encodeURIComponent(plantCode)}/check`\n    ),\n\n  /**\n   * Get user information by ID\n   * @param {string} id - User ID\n   * @returns {Promise<Object>} User information\n   */\n  getUserById: id => apiClient.get(`/admin/users/${id}`),\n\n  /**\n   * Get all users (cached for 5 minutes)\n   * @param {Object} options - Additional options including signal for AbortController\n   * @returns {Promise<Array>} Array of all users\n   */\n  getAllUsers: (options = {}) => apiClient.get('/admin/users', {\n    cacheTTL: 5 * 60 * 1000, // Cache for 5 minutes\n    ...options\n  }),\n\n  /**\n   * Get all users without cache (for real-time data)\n   * @param {Object} options - Additional options including signal for AbortController\n   * @returns {Promise<Array>} Array of all users\n   */\n  getAllUsersRealTime: (options = {}) => apiClient.get('/admin/users', {\n    useCache: false,\n    ...options\n  })\n};\n","import apiClient from '../api/client';\n\nexport const masterDataAPI = {\n  // Location Master (Plants) endpoints\n  getAllLocations: async () => {\n    try {\n      return await apiClient.get('/master-data/locations');\n    } catch (error) {\n      console.warn('Main locations endpoint failed, trying fallback:', error);\n      try {\n        return await apiClient.get('/master-data/locations/fallback');\n      } catch (fallbackError) {\n        console.warn('Fallback endpoint failed, trying simple endpoint:', fallbackError);\n        try {\n          return await apiClient.get('/simple-locations');\n        } catch (simpleError) {\n          console.error('All locations endpoints failed:', simpleError);\n          throw simpleError;\n        }\n      }\n    }\n  },\n\n  getLocationByCode: locationCode =>\n    apiClient.get(`/master-data/locations/${encodeURIComponent(locationCode)}`),\n\n  searchLocations: searchTerm =>\n    apiClient.get(`/master-data/locations/search?term=${encodeURIComponent(searchTerm)}`),\n\n  createLocation: locationData => apiClient.post('/master-data/locations', locationData),\n\n  updateLocation: (locationCode, locationData) =>\n    apiClient.put(`/master-data/locations/${encodeURIComponent(locationCode)}`, locationData),\n\n  deleteLocation: locationCode =>\n    apiClient.delete(`/master-data/locations/${encodeURIComponent(locationCode)}`),\n\n\n\n  // Project Item Master endpoints\n  getAllProjectItems: () => apiClient.get('/master-data/project-items'),\n\n  getItemsByProject: projectCode =>\n    apiClient.get(`/master-data/project-items/projects/${encodeURIComponent(projectCode)}`),\n\n  getProjectsByItem: itemCode =>\n    apiClient.get(`/master-data/project-items/items/${encodeURIComponent(itemCode)}`),\n\n  getAllProjectCodes: () => apiClient.get('/master-data/project-codes'),\n\n  getAllItemCodes: () => apiClient.get('/master-data/item-codes'),\n\n  getItemCodesByProject: projectCode =>\n    apiClient.get(`/master-data/project-codes/${encodeURIComponent(projectCode)}/items`),\n\n  // Test endpoints\n  testLocationMaster: () => apiClient.get('/master-data/locations/test'),\n\n  testSimpleLocation: () => apiClient.get('/simple-locations/test'),\n\n  diagnosticLocationMaster: () => apiClient.get('/master-data/locations/diagnostic'),\n\n  getSimpleLocationCount: () => apiClient.get('/simple-locations/count')\n};\n"],"names":["InfoCircleOutlined","props","ref","React","AntdIcon","_extends","icon","InfoCircleOutlinedSvg","ensureArray","data","fallback","arguments","length","undefined","Array","isArray","console","warn","safeApiResponse","response","dataKey","keys","split","key","safeRolesData","roles","map","role","name","id","roleName","Math","random","toString","safePlantData","plantData","assignedPlants","primaryPlant","plants","primary","UserErrorBoundary","constructor","super","reportError","error","errorInfo","context","message","stack","timestamp","Date","toISOString","handleRetry","this","setState","hasError","onRetry","handleGoHome","window","location","href","state","getDerivedStateFromError","componentDidCatch","level","component","render","_jsx","Result","status","title","subTitle","extra","Button","type","onClick","children","style","padding","process","defaultProps","Text","Title","Typography","NotificationPreferencesPreview","_ref","selectedRoles","visible","previewData","setPreviewData","useState","loading","setLoading","getPrimaryRoleName","useCallback","primaryRoleId","find","r","startsWith","endsWith","substring","useEffect","async","primaryRole","apiClient","get","success","preferences","defaultPreferences","loadPreview","_jsxs","Card","BellOutlined","marginRight","size","marginTop","Alert","description","showIcon","marginBottom","textAlign","Spin","marginLeft","strong","Tag","color","Row","gutter","Object","entries","_ref2","enabled","Col","xs","sm","md","backgroundColor","border","borderRadius","display","justifyContent","alignItems","fontSize","replace","usePlantAssignment","availablePlants","setAvailablePlants","plantsLoading","setPlantsLoading","setError","fetchPlants","locations","masterDataAPI","getAllLocations","signal","aborted","plantOptions","label","locationCode","value","err","warning","getPlantDescription","plantCode","plant","p","validatePlantAssignments","errors","push","includes","filterPlants","input","option","_option$label","toLowerCase","getAvailablePlantsForAssignment","currentAssignments","filter","controller","AbortController","abort","primaryPlantOptions","useMemo","disabled","PlantAssignmentForm","_form$getFieldValue","_form$getFieldValue2","form","initialValues","isPlantUserSelected","plantRoleIds","some","roleId","handleRefreshPlants","validateAssignedPlants","_","Promise","resolve","reject","Error","validatePrimaryPlant","getFieldValue","handleAssignedPlantsChange","values","currentPrimaryPlant","setFieldValue","setFieldsValue","_Fragment","Divider","ReloadOutlined","Form","Item","rules","validator","hasFeedback","tooltip","Select","mode","placeholder","options","showSearch","filterOption","onChange","maxTagCount","allowClear","displayName","UserModal","editingUser","onSave","onCancel","useForm","setSelectedRoles","plantAssignmentData","setPlantAssignmentData","isEditMode","Boolean","modalTitle","validationRules","username","ValidationRules","email","password","required","min","roleOptions","handleSubmit","resetFields","handleCancel","handleOk","submit","loadPlantAssignmentData","userAPI","getUserPlantAssignments","userRoles","Modal","open","onOk","confirmLoading","destroyOnClose","width","maskClosable","SecureForm","labelCol","span","wrapperCol","onFinish","preserve","componentName","enableSecurityLogging","SecureFormItem","validationType","SecureInput","fieldName","Input","Password","UserTable","users","onEdit","onDelete","columns","dataIndex","sorter","a","b","localeCompare","join","record","plantAssignments","trim","EditOutlined","danger","DeleteOutlined","tableProps","safeUsers","dataSource","rowKey","pagination","pageSize","showSizeChanger","showQuickJumper","showTotal","total","range","scroll","x","Table","locale","emptyText","createSimpleApiClient","require","post","put","delete","USER_ACTIONS","initialState","modalVisible","userReducer","action","payload","Users","actions","useUserManagement","dispatch","useReducer","fetchUsers","usersArray","usersWithPlants","all","user","fetchRoles","rolesArray","deleteUser","userId","saveUser","userData","roleIds","roleError","updateUserPlantAssignments","userPayload","log","openEditModal","openAddModal","closeModal","initializeData","handleTestLocationAPI","result","testLocationMaster","handleTestSimpleAPI","testSimpleLocation","handleDiagnosticAPI","diagnosticLocationMaster","info","handleTestUserRoles","default","handleGoToLogin","handleFixAdminRoles","currentUser","getCurrentUser","getUserRoles","authenticated","isAuthenticated","Space","wrap","TextArea","onValidationChange","validateInput","useInputValidation","validationState","setValidationState","isValid","wasModified","handleChange","e","inputValue","target","validation","SecurityAuditLogger","logXSSAttempt","sanitizedValue","SecureTextArea","_ref3","securityEvents","setSecurityEvents","handleFinish","sanitizedValues","securityIssues","forEach","originalValue","InputSanitizer","sanitizeText","field","issue","events","getRecentEvents","slice","validateTrigger","_ref4","securityRules","baseRules","projectCode","materialCode","text","richText","prepareToken","token","lineWidth","fontSizeIcon","calc","tagFontSize","fontSizeSM","mergeToken","tagLineHeight","unit","lineHeightSM","mul","equal","tagIconSize","sub","tagPaddingHorizontal","tagBorderlessBg","defaultBg","prepareComponentToken","FastColor","colorFillQuaternary","onBackground","colorBgContainer","toHexString","defaultColor","colorText","genStyleHooks","paddingXXS","componentCls","paddingInline","iconMarginInline","assign","resetComponent","height","marginInlineEnd","marginXS","lineHeight","whiteSpace","background","lineType","colorBorder","borderRadiusSM","opacity","transition","motionDurationMid","position","direction","marginInlineStart","colorIcon","cursor","colorTextHeading","borderColor","iconCls","colorTextLightSolid","colorPrimary","colorFillSecondary","colorPrimaryHover","colorPrimaryActive","genBaseStyle","__rest","s","t","prototype","hasOwnProperty","call","indexOf","getOwnPropertySymbols","i","propertyIsEnumerable","CheckableTag","prefixCls","customizePrefixCls","className","checked","restProps","getPrefixCls","tag","ConfigContext","wrapCSSVar","hashId","cssVarCls","useStyle","cls","classNames","genSubStyleComponent","genPresetColor","colorKey","textColor","lightBorderColor","lightColor","darkColor","genPresetStyle","genTagStatusStyle","cssVariableType","capitalizedCssVariableType","str","charAt","toUpperCase","tagToken","InternalTag","tagProps","rootClassName","onClose","bordered","deprecatedVisible","tagContext","setVisible","domProps","omit","isPreset","isPresetColor","isStatus","isPresetStatusColor","isInternalColor","tagStyle","tagClassName","handleCloseClick","stopPropagation","defaultPrevented","mergedCloseIcon","useClosable","pickClosable","closable","closeIconRender","iconNode","replacement","replaceElement","originProps","_a","isNeedWave","kids","tagNode","PresetCmp","StatusCmp","Wave","effectivePlant","isPlantUser","getToken","validationResponse","plantCodes","valid","tokenError","possibleKeys","storedUserData","localStorage","getItem","sessionStorage","JSON","parse","parseError","adminToken","isAdmin","_userDetails$users","adminError","encodeURIComponent","checkUserPlantAssignment","getUserById","getAllUsers","cacheTTL","getAllUsersRealTime","useCache","fallbackError","simpleError","getLocationByCode","searchLocations","searchTerm","createLocation","locationData","updateLocation","deleteLocation","getAllProjectItems","getItemsByProject","getProjectsByItem","itemCode","getAllProjectCodes","getAllItemCodes","getItemCodesByProject","getSimpleLocationCount"],"sourceRoot":""}