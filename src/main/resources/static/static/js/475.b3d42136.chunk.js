"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[475],{2868:(e,s,t)=>{t.d(s,{aZ:()=>c,lX:()=>p,rb:()=>a,Bq:()=>g,fz:()=>i,cS:()=>n,pZ:()=>d,tS:()=>E,r0:()=>u,EW:()=>l,sB:()=>o,Fv:()=>r});const l={MOBILE_BREAKPOINT:768,TABLET_BREAKPOINT:1024,PAGE_SIZE:10,DEBOUNCE_DELAY:300},r={INITIATED:"INITIATED",IN_PROGRESS:"IN_PROGRESS",PENDING_REVIEW:"PENDING_REVIEW",APPROVED:"APPROVED",REJECTED:"REJECTED",COMPLETED:"COMPLETED"},i={LOW:"LOW",MEDIUM:"MEDIUM",HIGH:"HIGH",URGENT:"URGENT",CRITICAL:"CRITICAL"},a=(r.INITIATED,r.IN_PROGRESS,r.PENDING_REVIEW,r.APPROVED,r.REJECTED,r.COMPLETED,i.LOW,i.MEDIUM,i.HIGH,i.URGENT,i.CRITICAL,{MAX_UPLOAD_SIZE:26214400,BYTES_PER_KB:1024,BYTES_PER_MB:1048576,BYTES_PER_GB:1073741824}),o={JVC_PENDING:"JVC_PENDING",PLANT_PENDING:"PLANT_PENDING",CQS_PENDING:"CQS_PENDING",TECH_PENDING:"TECH_PENDING",DRAFT:"DRAFT",IN_PROGRESS:"IN_PROGRESS",COMPLETED:"COMPLETED"},n={OPEN:"OPEN",RESOLVED:"RESOLVED",CLOSED:"CLOSED"},d={ACTIVE:["OPEN"],INACTIVE:["RESOLVED","CLOSED"]},u={CQS:"CQS",TECH:"TECH",JVC:"JVC",PLANT:"PLANT"},c={INTERVAL:4e4,DEBOUNCE_DELAY:15e3},g={DEFAULT_PAGE_SIZE:10,SMALL_PAGE_SIZE:5,LARGE_PAGE_SIZE:15,SHOW_SIZE_CHANGER:!0,SHOW_QUICK_JUMPER:!0},p={ALL:"all",COMPLETED:"completed",IN_PROGRESS:"in-progress",NOT_STARTED:"not-started"},E={INITIATE:"initiate",PENDING:"pending",COMPLETED:"completed",QUERIES:"queries",HISTORY:"history"}},3661:(e,s,t)=>{t.d(s,{B:()=>r});var l=t(6649);const r={createQuery:(e,s)=>l.default.post(`/queries/workflow/${e}`,s),getQuery:e=>l.default.get(`/queries/${e}`),updateQuery:(e,s)=>l.default.put(`/queries/${e}`,s),deleteQuery:e=>l.default.delete(`/queries/${e}`),resolveQuery:(e,s)=>l.default.post(`/queries/${e}/resolve`,s),reopenQuery:(e,s)=>l.default.post(`/queries/${e}/reopen`,{reason:s}),assignQuery:(e,s)=>l.default.post(`/queries/${e}/assign`,s),reassignQuery:(e,s,t)=>l.default.put(`/queries/${e}/assign`,{team:s,reason:t}),getAllQueries:()=>l.default.get("/queries"),getQueriesByWorkflow:e=>l.default.get(`/queries/workflow/${e}`),getQueriesByTeam:e=>l.default.get(`/queries/team/${e}`),getQueriesByStatus:e=>l.default.get(`/queries/status/${e}`),getQueriesByUser:e=>l.default.get("/queries/my-raised"),searchQueries:e=>{const s=new URLSearchParams(e).toString();return l.default.get(`/queries/search?${s}`)},getQueryStats:e=>l.default.get(`/queries/recent?days=${e}`),getQueryCountsByTeam:e=>l.default.get(`/queries/stats/count-open/${e}`),getAvgResolutionTimeByTeam:e=>l.default.get(`/queries/stats/avg-resolution-time/${e}`),getOverdueQueries:function(){return l.default.get("/queries/overdue")},getOverdueQueriesCountByTeam:e=>l.default.get(`/queries/stats/overdue-count/${e}`),getQueriesResolvedTodayByTeam:e=>l.default.get(`/queries/stats/resolved-today/${e}`),getQuerySLAStatus:e=>l.default.get(`/queries/${e}/is-overdue`),getQueriesNearingSLA:function(){return l.default.get("/queries/needing-attention")},addQueryComment:(e,s)=>l.default.post(`/queries/${e}/comments`,{comment:s}),getQueryComments:e=>l.default.get(`/queries/${e}/comments`),updateQueryPriority:(e,s)=>l.default.put(`/queries/${e}/priority`,{priority:s}),escalateQuery:(e,s)=>l.default.put(`/queries/${e}/priority`,{priorityLevel:"HIGH"}),uploadQueryDocuments:(e,s)=>l.default.upload(`/queries/${e}/documents`,s),uploadResponseDocuments:(e,s,t)=>l.default.upload(`/queries/${e}/responses/${s}/documents`,t),getQueryDocuments:e=>l.default.get(`/queries/${e}/documents`),downloadQueryDocument:(e,s)=>l.default.download(`/queries/${e}/documents/${s}/download`),deleteQueryDocument:(e,s)=>l.default.delete(`/queries/${e}/documents/${s}`),closeQuery:(e,s)=>l.default.post(`/queries/${e}/close`,{reason:s}),canPlantEditForm:e=>l.default.get(`/queries/workflow/${e}/can-edit`),getQueryStatusSummary:e=>l.default.get(`/queries/workflow/${e}/status-summary`)}},5423:(e,s,t)=>{t.d(s,{PK:()=>g,kz:()=>u,m6:()=>c,ww:()=>d,yE:()=>p});var l=t(4135),r=t(1686),i=(t(5043),t(3719)),a=t(1028),o=t(579);const n=e=>{let{children:s,roles:t=[],requireAll:a=!1,fallback:n=null,loading:d=!1,showFallback:u=!0}=e;if(d)return(0,o.jsx)(r.A,{size:"large"});if(!(0,i.wR)())return u?(0,o.jsx)(l.Ay,{status:"warning",title:"Authentication Required",subTitle:"Please log in to access this content."}):null;if(!t||0===t.length)return s;const c=(0,i.qc)(),g=a?t.every(e=>(0,i.hf)(e)):t.some(e=>(0,i.hf)(e));return c||g?s:n||(u?(0,o.jsx)(l.Ay,{status:"403",title:"Access Denied",subTitle:`This content requires one of the following roles: ${t.join(", ")} or ADMIN privileges`}):null)},d=e=>{let{children:s,fallback:t=null,showFallback:r=!0}=e;if(!(0,i.wR)())return r?(0,o.jsx)(l.Ay,{status:"warning",title:"Authentication Required",subTitle:"Please log in to access this content."}):null;const n=(0,i.HW)(),d=(0,i.qc)(),u=(0,i.hf)("ADMIN"),c=(0,i.hf)("admin"),g=(0,i.hf)("ROLE_ADMIN"),p=(0,i.gf)();let E=!1,m=!1;if(p)try{var f,h;const e=a.A.getTokenPayload(p);E=!0===(null===e||void 0===e?void 0:e.isAdmin),m=(null===e||void 0===e||null===(f=e.roles)||void 0===f?void 0:f.includes("ADMIN"))||(null===e||void 0===e||null===(h=e.authorities)||void 0===h?void 0:h.includes("ADMIN"))}catch(A){console.error("Error checking token in AdminOnly:",A)}const y=d||u||c||g||E||m;return console.log("AdminOnly Enhanced Debug:",{currentUser:n,adminStatus:d,hasAdminRole:u,hasAdminRoleLower:c,hasRoleAdmin:g,tokenIsAdmin:E,tokenHasAdminRole:m,finalHasAccess:y,token:p?"present":"missing"}),y?s:t||(r?(0,o.jsx)(l.Ay,{status:"403",title:"Access Denied",subTitle:`This content requires administrator privileges. Debug: user=${n}, isAdmin=${d}, hasRole=${u}, tokenAdmin=${E}`}):null)},u=e=>{let{children:s,fallback:t=null,showFallback:l=!0}=e;return(0,o.jsx)(n,{roles:["JVC_USER","JVC_ROLE","ADMIN"],fallback:t,showFallback:l,children:s})},c=e=>{let{children:s,fallback:t=null,showFallback:l=!0}=e;return(0,o.jsx)(n,{roles:["CQS_USER","CQS_ROLE","ADMIN"],fallback:t,showFallback:l,children:s})},g=e=>{let{children:s,fallback:t=null,showFallback:l=!0}=e;return(0,o.jsx)(n,{roles:["TECH_USER","TECH_ROLE","ADMIN"],fallback:t,showFallback:l,children:s})},p=e=>{let{children:s,fallback:t=null,showFallback:l=!0}=e;return(0,o.jsx)(n,{roles:["PLANT_USER","PLANT_ROLE","ADMIN"],fallback:t,showFallback:l,children:s})}},7933:(e,s,t)=>{t.d(s,{A:()=>R});var l=t(6237),r=t(1966),i=t(9470),a=t(132),o=t(4733),n=t(2261),d=t(5206),u=t(9073),c=t(4522),g=t(6569),p=t(7692),E=t(6051),m=t(3927),f=t(9677),h=t(5043),y=t(2868),A=t(3661),I=t(579);const{Text:x}=m.A,{Dragger:D}=f.A,R=e=>{let{queryId:s,responseId:t,onUploadComplete:m,maxFiles:f=5,disabled:R=!1,context:T="query"}=e;const[N,P]=(0,h.useState)([]),[S,j]=(0,h.useState)(!1),[C,O]=(0,h.useState)(0),$=e=>{if(0===e)return"0 Bytes";const s=Math.floor(Math.log(e)/Math.log(1024));return`${parseFloat((e/Math.pow(1024,s)).toFixed(2))} ${["Bytes","KB","MB","GB"][s]}`},w="response"===T?"Response":"Query",L=N.filter(e=>"done"===e.status).length;return(0,I.jsx)(u.A,{size:"small",title:(0,I.jsxs)(E.A,{children:[(0,I.jsx)(o.A,{}),(0,I.jsxs)("span",{children:["Upload Documents to ",w]})]}),style:{backgroundColor:"#fafafa",border:"1px dashed #d9d9d9"},children:(0,I.jsxs)(E.A,{direction:"vertical",style:{width:"100%"},children:[(0,I.jsx)(n.A,{message:`Document Upload for ${w}`,description:(0,I.jsxs)("ul",{style:{margin:0,paddingLeft:20},children:[(0,I.jsx)("li",{children:"Supported formats: PDF, Word (.doc, .docx), Excel (.xls, .xlsx), Images (JPG, PNG)"}),(0,I.jsx)("li",{children:"Maximum file size: 25MB per file"}),(0,I.jsxs)("li",{children:["Maximum ",f," files allowed"]}),(0,I.jsxs)("li",{children:["Files will be attached to this ",T.toLowerCase()]})]}),type:"info",showIcon:!0,size:"small",style:{marginBottom:16}}),(0,I.jsxs)(D,{multiple:!0,fileList:N,onChange:e=>{let{fileList:s}=e;s.length>f&&(g.Ay.warning(`Maximum ${f} files allowed. Only the first ${f} files will be processed.`),s=s.slice(0,f));const t=s.map(e=>{if(e.originFileObj){const s=(e=>{const s=y.rb.MAX_UPLOAD_SIZE,t=e.name.toLowerCase().substring(e.name.lastIndexOf("."));return{isValidType:["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","image/jpeg","image/jpg","image/png"].includes(e.type)||[".pdf",".doc",".docx",".xls",".xlsx",".jpg",".jpeg",".png"].includes(t),isValidSize:e.size<=s,type:e.type,size:e.size,extension:t}})(e.originFileObj);s.isValidType?s.isValidSize?(e.status="done",e.percent=100):(e.status="error",e.response=`File size exceeds 25MB limit (${(e.originFileObj.size/1024/1024).toFixed(2)}MB).`):(e.status="error",e.response="Invalid file type. Only PDF, Word, Excel, and image files (JPG, PNG) are allowed."),e.size=e.originFileObj.size,e.type=e.originFileObj.type,e.lastModified=e.originFileObj.lastModified}return e});P(t);const l=t.filter(e=>"done"===e.status).length,r=t.filter(e=>"error"===e.status).length;r>0?g.Ay.warning(`${r} file(s) have validation errors. Please check file types and sizes.`):l>0&&g.Ay.success(`${l} file(s) ready for upload.`)},beforeUpload:()=>!1,accept:".pdf,.doc,.docx,.xls,.xlsx,.jpg,.jpeg,.png",disabled:R||S,style:{marginBottom:16},children:[(0,I.jsx)("p",{className:"ant-upload-drag-icon",children:(0,I.jsx)(a.A,{})}),(0,I.jsx)("p",{className:"ant-upload-text",children:"Click or drag files to this area to upload"}),(0,I.jsx)("p",{className:"ant-upload-hint",children:"Support for PDF, Word, Excel, and image files. Maximum 25MB each."})]}),S&&C>0&&(0,I.jsx)(u.A,{size:"small",style:{marginBottom:16},children:(0,I.jsxs)(E.A,{direction:"vertical",style:{width:"100%"},children:[(0,I.jsx)(x,{children:"Uploading documents..."}),(0,I.jsx)(p.A,{percent:C,status:100===C?"success":"active",strokeColor:{"0%":"#108ee9","100%":"#87d068"}})]})}),N.length>0&&(0,I.jsx)(u.A,{size:"small",title:`Selected Files (${N.length}/${f})`,style:{marginBottom:16},children:(0,I.jsx)(c.A,{size:"small",dataSource:N,renderItem:e=>(0,I.jsx)(c.A.Item,{actions:[(0,I.jsx)(d.Ay,{type:"text",danger:!0,icon:(0,I.jsx)(r.A,{}),onClick:()=>(e=>{const s=N.filter(s=>s.uid!==e.uid);P(s)})(e),size:"small",disabled:S,children:"Remove"},"remove")],children:(0,I.jsx)(c.A.Item.Meta,{avatar:"done"===e.status?(0,I.jsx)(l.A,{style:{color:"#52c41a"}}):(0,I.jsx)(i.A,{style:{color:"#ff4d4f"}}),title:(0,I.jsxs)(E.A,{children:[(0,I.jsx)(x,{strong:"done"===e.status,type:"error"===e.status?"danger":"default",children:e.name}),e.size&&(0,I.jsxs)(x,{type:"secondary",children:["(",$(e.size),")"]})]}),description:"error"===e.status?(0,I.jsx)(x,{type:"danger",children:e.response}):(0,I.jsx)(x,{type:"secondary",children:"Ready for upload"})})})})}),(0,I.jsx)("div",{style:{textAlign:"center"},children:(0,I.jsx)(d.Ay,{type:"primary",icon:(0,I.jsx)(o.A,{}),onClick:async()=>{const e=N.filter(e=>"done"===e.status);if(0!==e.length)if(s)try{j(!0),O(0);const l=e.map(e=>e.originFileObj||e),r=setInterval(()=>{O(e=>e>=90?(clearInterval(r),90):e+10)},200);let i;i="response"===T&&t?await A.B.uploadResponseDocuments(s,t,l):await A.B.uploadQueryDocuments(s,l),clearInterval(r),O(100),g.Ay.success(`Successfully uploaded ${e.length} document(s) to the ${T}.`),P([]),O(0),m&&m(i)}catch(l){console.error("Error uploading documents:",l),g.Ay.error(`Failed to upload documents to ${T}. Please try again.`),O(0)}finally{j(!1)}else g.Ay.error("Query ID is required for document upload.");else g.Ay.error("Please select at least one valid file to upload.")},loading:S,disabled:R||0===L,size:"large",children:S?`Uploading ${L} Document(s)...`:`Upload ${L} Document(s) to ${w}`})}),N.length>0&&(0,I.jsx)(n.A,{message:"File Validation Summary",description:(0,I.jsxs)(E.A,{direction:"vertical",size:"small",children:[(0,I.jsxs)(x,{children:[(0,I.jsx)(l.A,{style:{color:"#52c41a",marginRight:4}}),"Valid files: ",L]}),N.filter(e=>"error"===e.status).length>0&&(0,I.jsxs)(x,{type:"danger",children:[(0,I.jsx)(i.A,{style:{marginRight:4}}),"Files with errors: ",N.filter(e=>"error"===e.status).length]})]}),type:N.filter(e=>"error"===e.status).length>0?"warning":"success",showIcon:!0,size:"small"})]})})}}}]);
//# sourceMappingURL=475.b3d42136.chunk.js.map