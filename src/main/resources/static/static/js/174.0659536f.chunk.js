"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[174],{6174:(e,l,i)=>{i.r(l),i.d(l,{default:()=>Y});var t=i(5920),s=i(1199),o=i(6886),n=i(6237),r=i(3390),d=i(119),a=i(5929),c=i(6840),x=i(9470),g=i(6191),p=i(6091),f=i(4786),h=i(3357),u=i(9760),y=i(4524),j=i(9654),v=i(8047),b=i(3722),m=i(9172),A=i(2261),S=i(5964),w=i(7490),k=i(5206),C=i(9073),z=i(1645),I=i(7326),R=i(9472),B=i(5444),T=i(7692),W=i(7419),F=i(1686),P=i(6612),q=i(8918),E=i(6399),D=i(6263),N=i(6651),L=i(3927),M=i(5043),Q=i(3216),H=i(6649),O=i(579);const{Title:V,Text:G,Paragraph:$}=L.A,{Panel:_}=I.A,{TextArea:U}=B.A,{TabPane:K}=q.A,Y=e=>{var l,i,I,B,L;let{workflowId:$,onClose:_}=e;const{workflowId:U}=(0,Q.g)(),Y=(0,Q.Zp)(),Z=$||U,[J,X]=(0,M.useState)(!0),[ee,le]=(0,M.useState)(null),[ie,te]=(0,M.useState)(null),[se,oe]=(0,M.useState)(0),[ne,re]=(0,M.useState)("overview");console.log("QuestionnaireViewerPage mounted with workflowId:",Z);const de=(0,M.useCallback)(async()=>{try{X(!0),console.log("Loading questionnaire data for workflowId:",Z);const e=await H.default.get(`/questionnaire/${Z}`);console.log("Questionnaire response:",e),te(e),le(null)}catch(l){var e;console.error("Error loading questionnaire:",l),console.error("Error details:",(null===(e=l.response)||void 0===e?void 0:e.data)||l.message),le("Failed to load questionnaire data. Please try again.")}finally{X(!1)}},[Z]);(0,M.useEffect)(()=>{Z?de():(le("No workflow ID provided"),X(!1))},[de,Z]);const ae=(e,l,i)=>{const t=e.fields.filter(e=>{const i=l[e.name]||e.cqsValue||"";return i&&""!==i.trim()}).length,s=e.fields.length>0?t/e.fields.length*100:0;return(0,O.jsxs)("div",{style:{marginBottom:32},children:[(0,O.jsx)(C.A,{style:{marginBottom:24,borderRadius:16,background:`linear-gradient(135deg, ${100===s?"#52c41a":s>0?"#faad14":"#8c8c8c"} 0%, ${100===s?"#73d13d":s>0?"#ffc53d":"#bfbfbf"} 100%)`,border:"none",color:"white"},bodyStyle:{padding:"24px 32px"},children:(0,O.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,O.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:16},children:[(0,O.jsx)(S.A,{size:48,style:{backgroundColor:"rgba(255,255,255,0.2)",color:"white",fontSize:20,fontWeight:700},children:e.stepNumber}),(0,O.jsxs)("div",{children:[(0,O.jsx)(V,{level:3,style:{margin:0,color:"white",fontWeight:600},children:e.title}),(0,O.jsxs)(G,{style:{color:"rgba(255,255,255,0.8)",fontSize:14},children:[t," of ",e.fields.length," fields completed \u2022 ",Math.round(s),"% done"]})]})]}),(0,O.jsxs)("div",{style:{textAlign:"right"},children:[(0,O.jsxs)("div",{style:{fontSize:32,fontWeight:700,marginBottom:4},children:[Math.round(s),"%"]}),(0,O.jsx)(T.A,{percent:s,showInfo:!1,strokeColor:"rgba(255,255,255,0.8)",trailColor:"rgba(255,255,255,0.2)",style:{width:120}})]})]})}),e.description&&(0,O.jsx)(C.A,{style:{marginBottom:24,borderRadius:12,borderLeft:"4px solid #1890ff",backgroundColor:"#f6ffed"},bodyStyle:{padding:"20px 24px"},children:(0,O.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:12},children:[(0,O.jsx)(f.A,{style:{color:"#1890ff",fontSize:16,marginTop:2}}),(0,O.jsx)(G,{style:{fontSize:14,color:"#595959",lineHeight:1.6},children:e.description})]})}),(0,O.jsx)(C.A,{title:(0,O.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},children:[(0,O.jsx)(S.A,{style:{backgroundColor:"#722ed1"},icon:(0,O.jsx)(u.A,{})}),(0,O.jsx)("span",{children:"Field Details"}),(0,O.jsx)(w.A,{count:e.fields.length,style:{backgroundColor:"#1890ff"}})]}),style:{borderRadius:16},bodyStyle:{padding:"24px"},children:e.fields.length>0?(0,O.jsx)(W.A,{gutter:[16,16],children:e.fields.map(e=>((e,l)=>{const i=l[e.name]||e.cqsValue||"",t=!i||""===i.trim(),s=e.cqsAutoPopulated;let d=i;if(!t&&"radio"===e.type&&e.options){const l=e.options.find(e=>e.value===i);d=l?l.label:i}else if(!t&&"select"===e.type&&e.options){const l=e.options.find(e=>e.value===i);d=l?l.label:i}return(0,O.jsx)(z.A,{xs:24,sm:12,lg:8,style:{marginBottom:16},children:(0,O.jsxs)(C.A,{hoverable:!0,style:{height:"100%",borderRadius:16,border:t?"2px dashed #e8e8e8":s?"2px solid #1890ff":"2px solid #f0f0f0",background:t?"#fafafa":s?"linear-gradient(135deg, #e6f7ff 0%, #f0f9ff 100%)":"#ffffff",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden"},bodyStyle:{padding:"20px"},children:[(0,O.jsx)("div",{style:{position:"absolute",top:0,right:0,width:0,height:0,borderLeft:"30px solid transparent",borderTop:t?"30px solid #faad14":"30px solid #52c41a"}}),(0,O.jsxs)("div",{style:{marginBottom:16,display:"flex",alignItems:"flex-start",gap:12},children:[(0,O.jsx)(S.A,{size:40,style:{backgroundColor:t?"#faad14":s?"#1890ff":"#52c41a",flexShrink:0},icon:(e=>{switch(e){case"radio":return(0,O.jsx)(n.A,{});case"select":return(0,O.jsx)(y.A,{});case"text":case"textarea":return(0,O.jsx)(p.A,{});default:return(0,O.jsx)(f.A,{})}})(e.type)}),(0,O.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,O.jsxs)(G,{strong:!0,style:{fontSize:15,color:"#262626",display:"block",lineHeight:1.3,marginBottom:4},children:[e.label,e.required&&(0,O.jsx)(G,{type:"danger",style:{marginLeft:4},children:"*"})]}),(0,O.jsxs)("div",{style:{display:"flex",gap:6,flexWrap:"wrap"},children:[(0,O.jsx)(E.A,{color:"radio"===e.type?"blue":"select"===e.type?"purple":"green",style:{fontSize:10,padding:"0 6px",borderRadius:8},children:e.type.toUpperCase()}),s&&(0,O.jsx)(E.A,{color:"processing",style:{fontSize:10,padding:"0 6px",borderRadius:8},children:"AUTO"})]})]})]}),(0,O.jsx)("div",{style:{padding:"16px",backgroundColor:t?"rgba(250, 173, 20, 0.1)":"rgba(82, 196, 26, 0.1)",borderRadius:12,border:t?"1px solid rgba(250, 173, 20, 0.3)":"1px solid rgba(82, 196, 26, 0.3)",minHeight:60,display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center"},children:t?(0,O.jsxs)("div",{children:[(0,O.jsx)(x.A,{style:{color:"#faad14",fontSize:20,marginBottom:8,display:"block"}}),(0,O.jsx)(G,{type:"secondary",style:{fontSize:13,fontStyle:"italic"},children:"No data provided"})]}):(0,O.jsxs)("div",{children:[(0,O.jsx)(r.A,{style:{color:"#52c41a",fontSize:16,marginBottom:8,display:"block"}}),(0,O.jsx)(G,{strong:!0,style:{fontSize:14,color:"#262626"},children:d})]})}),e.helpText&&(0,O.jsx)("div",{style:{marginTop:12,padding:"8px 12px",backgroundColor:"rgba(24, 144, 255, 0.05)",borderRadius:8,borderLeft:"3px solid #1890ff"},children:(0,O.jsxs)(G,{type:"secondary",style:{fontSize:11,lineHeight:1.4},children:[(0,O.jsx)(o.A,{style:{marginRight:4,color:"#1890ff"}}),e.helpText]})})]})},e.name)})(e,l))}):(0,O.jsx)(R.A,{description:"No fields available for this step",image:R.A.PRESENTED_IMAGE_SIMPLE})})]},e.stepNumber)};if(J)return(0,O.jsxs)("div",{style:{textAlign:"center",padding:"60px 20px"},children:[(0,O.jsx)(F.A,{size:"large"}),(0,O.jsx)("div",{style:{marginTop:16},children:"Loading questionnaire data..."}),(0,O.jsxs)("div",{style:{marginTop:8,color:"#666"},children:["Workflow ID: ",Z]})]});if(ee)return(0,O.jsx)("div",{style:{padding:24},children:(0,O.jsxs)(C.A,{children:[(0,O.jsx)(k.Ay,{icon:(0,O.jsx)(t.A,{}),onClick:()=>_?_():Y(-1),style:{marginBottom:16},children:"Back"}),(0,O.jsx)(A.A,{message:"Error Loading Questionnaire",description:(0,O.jsxs)("div",{children:[(0,O.jsx)("div",{children:ee}),(0,O.jsxs)("div",{style:{marginTop:8,fontSize:"12px",color:"#666"},children:["Workflow ID: ",Z]})]}),type:"error",showIcon:!0,action:(0,O.jsx)(k.Ay,{size:"small",onClick:de,children:"Retry"})})]})});if(!ie)return(0,O.jsx)("div",{style:{padding:24},children:(0,O.jsx)(A.A,{message:"No Data Found",description:"Questionnaire data not found.",type:"warning",showIcon:!0})});const{template:ce,plantData:xe,workflow:ge,completionStatus:pe,cqsData:fe,accessControl:he}=ie,ue=(null===xe||void 0===xe?void 0:xe.plantInputs)||{};null===fe||void 0===fe||fe.data;return console.log("Full questionnaire data:",ie),console.log("Plant data:",xe),console.log("Plant inputs:",ue),console.log("Plant inputs keys:",Object.keys(ue)),console.log("Template steps:",null===ce||void 0===ce?void 0:ce.steps),null!==ce&&void 0!==ce&&null!==(l=ce.steps)&&void 0!==l&&null!==(i=l[0])&&void 0!==i&&i.fields&&console.log("First step fields:",ce.steps[0].fields.map(e=>({name:e.name,label:e.label}))),(0,O.jsx)("div",{style:{background:"linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%)",minHeight:"100vh",padding:"16px"},children:(0,O.jsxs)("div",{style:{maxWidth:1400,margin:"0 auto"},children:[(0,O.jsx)(m.A,{offsetTop:16,children:(0,O.jsx)(C.A,{style:{marginBottom:24,borderRadius:20,border:"none",boxShadow:"0 12px 40px rgba(0,0,0,0.15)",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white"},bodyStyle:{padding:"20px 32px"},children:(0,O.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,O.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:20},children:[(0,O.jsx)(k.Ay,{icon:(0,O.jsx)(t.A,{}),onClick:()=>_?_():Y(-1),style:{backgroundColor:"rgba(255,255,255,0.15)",border:"2px solid rgba(255,255,255,0.3)",color:"white",borderRadius:12,height:44,fontWeight:600},size:"large",children:"Back"}),(0,O.jsxs)("div",{children:[(0,O.jsx)(V,{level:2,style:{margin:0,color:"white",fontWeight:700},children:"\ud83d\ude80 QRMFG Questionnaire Dashboard"}),(0,O.jsxs)(G,{style:{color:"rgba(255,255,255,0.9)",fontSize:15},children:[null===ge||void 0===ge?void 0:ge.materialName," \u2022 ",null===ge||void 0===ge?void 0:ge.plantCode," \u2022 Workflow #",Z]})]})]}),(0,O.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:16},children:[(0,O.jsxs)(E.A,{style:{backgroundColor:"rgba(255,255,255,0.15)",border:"2px solid rgba(255,255,255,0.3)",color:"white",borderRadius:20,padding:"6px 16px",fontSize:13,fontWeight:600},children:[(0,O.jsx)(g.A,{})," READ-ONLY"]}),(0,O.jsx)(S.A.Group,{children:(0,O.jsx)(N.A,{title:null===he||void 0===he?void 0:he.currentUser,children:(0,O.jsx)(S.A,{style:{backgroundColor:"#f56a00"},icon:(0,O.jsx)(b.A,{})})})})]})]})})}),(0,O.jsx)(C.A,{style:{borderRadius:20,border:"none",boxShadow:"0 8px 32px rgba(0,0,0,0.1)",overflow:"hidden"},bodyStyle:{padding:0},children:(0,O.jsxs)(q.A,{activeKey:ne,onChange:re,size:"large",style:{margin:0},tabBarStyle:{margin:0,padding:"0 32px",backgroundColor:"#fafbfc",borderBottom:"2px solid #f0f0f0"},children:[(0,O.jsx)(K,{tab:(0,O.jsxs)("span",{style:{display:"flex",alignItems:"center",gap:8,fontSize:15,fontWeight:600},children:[(0,O.jsx)(c.A,{}),"Overview Dashboard"]}),children:(0,O.jsx)("div",{style:{padding:"32px"},children:(e=>{var l,i,t;const{template:o,plantData:d,workflow:a,completionStatus:c}=e,x=(null===o||void 0===o||null===(l=o.steps)||void 0===l?void 0:l.length)||0,g=(null===o||void 0===o||null===(i=o.steps)||void 0===i?void 0:i.filter(e=>{const l=e.fields||[];return l.filter(e=>{var l;const i=(null===d||void 0===d||null===(l=d.plantInputs)||void 0===l?void 0:l[e.name])||e.cqsValue||"";return i&&""!==i.trim()}).length===l.length}).length)||0,f=x>0?Math.round(g/x*100):0;return(0,O.jsxs)("div",{style:{padding:"0 4px"},children:[(0,O.jsxs)(W.A,{gutter:[24,24],style:{marginBottom:32},children:[(0,O.jsx)(z.A,{xs:24,sm:12,lg:6,children:(0,O.jsx)(C.A,{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",border:"none",borderRadius:16,color:"white",textAlign:"center"},children:(0,O.jsx)(P.A,{title:(0,O.jsx)("span",{style:{color:"rgba(255,255,255,0.8)"},children:"Overall Progress"}),value:f,suffix:"%",valueStyle:{color:"white",fontSize:36,fontWeight:700},prefix:(0,O.jsx)(h.A,{})})})}),(0,O.jsx)(z.A,{xs:24,sm:12,lg:6,children:(0,O.jsx)(C.A,{style:{background:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",border:"none",borderRadius:16,color:"white",textAlign:"center"},children:(0,O.jsx)(P.A,{title:(0,O.jsx)("span",{style:{color:"rgba(255,255,255,0.8)"},children:"Completed Steps"}),value:g,suffix:`/ ${x}`,valueStyle:{color:"white",fontSize:36,fontWeight:700},prefix:(0,O.jsx)(n.A,{})})})}),(0,O.jsx)(z.A,{xs:24,sm:12,lg:6,children:(0,O.jsx)(C.A,{style:{background:"linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)",border:"none",borderRadius:16,color:"white",textAlign:"center"},children:(0,O.jsx)(P.A,{title:(0,O.jsx)("span",{style:{color:"rgba(255,255,255,0.8)"},children:"Total Fields"}),value:(null===c||void 0===c?void 0:c.totalFields)||0,valueStyle:{color:"white",fontSize:36,fontWeight:700},prefix:(0,O.jsx)(p.A,{})})})}),(0,O.jsx)(z.A,{xs:24,sm:12,lg:6,children:(0,O.jsx)(C.A,{style:{background:"linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)",border:"none",borderRadius:16,color:"white",textAlign:"center"},children:(0,O.jsx)(P.A,{title:(0,O.jsx)("span",{style:{color:"rgba(255,255,255,0.8)"},children:"Completed Fields"}),value:(null===c||void 0===c?void 0:c.completedFields)||0,valueStyle:{color:"white",fontSize:36,fontWeight:700},prefix:(0,O.jsx)(j.A,{})})})})]}),(0,O.jsx)(C.A,{title:(0,O.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},children:[(0,O.jsx)(S.A,{style:{backgroundColor:"#1890ff"},icon:(0,O.jsx)(s.A,{})}),(0,O.jsx)("span",{children:"Step Progress Timeline"})]}),style:{borderRadius:16,marginBottom:24},children:(0,O.jsx)(D.A,{mode:"left",children:null===o||void 0===o||null===(t=o.steps)||void 0===t?void 0:t.map((e,l)=>{const i=e.fields||[],t=i.filter(e=>{var l;const i=(null===d||void 0===d||null===(l=d.plantInputs)||void 0===l?void 0:l[e.name])||e.cqsValue||"";return i&&""!==i.trim()}),s=i.length>0?Math.round(t.length/i.length*100):0,o=100===s;return(0,O.jsx)(D.A.Item,{color:o?"#52c41a":s>0?"#faad14":"#d9d9d9",dot:(0,O.jsx)(S.A,{size:32,style:{backgroundColor:o?"#52c41a":s>0?"#faad14":"#d9d9d9"},children:o?(0,O.jsx)(r.A,{}):e.stepNumber}),children:(0,O.jsxs)("div",{style:{paddingBottom:16},children:[(0,O.jsx)(V,{level:5,style:{margin:0,marginBottom:8},children:e.title}),(0,O.jsx)(G,{type:"secondary",style:{display:"block",marginBottom:12},children:e.description}),(0,O.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:16},children:[(0,O.jsx)(T.A,{percent:s,size:"small",style:{flex:1},strokeColor:o?"#52c41a":"#1890ff"}),(0,O.jsxs)(G,{strong:!0,style:{fontSize:13},children:[t.length,"/",i.length," fields"]})]})]})},l)})})})]})})(ie)})},"overview"),(0,O.jsx)(K,{tab:(0,O.jsxs)("span",{style:{display:"flex",alignItems:"center",gap:8,fontSize:15,fontWeight:600},children:[(0,O.jsx)(p.A,{}),"Detailed Steps",(0,O.jsx)(w.A,{count:(null===ce||void 0===ce||null===(I=ce.steps)||void 0===I?void 0:I.length)||0,style:{backgroundColor:"#1890ff"}})]}),children:(0,O.jsx)("div",{style:{padding:"32px",backgroundColor:"#fafbfc"},children:(null===ce||void 0===ce||null===(B=ce.steps)||void 0===B?void 0:B.length)>0?ce.steps.map(e=>ae(e,ue)):(0,O.jsx)(R.A,{description:"No questionnaire steps available",image:R.A.PRESENTED_IMAGE_SIMPLE,style:{padding:"60px 0"}})})},"details"),(0,O.jsx)(K,{tab:(0,O.jsxs)("span",{style:{display:"flex",alignItems:"center",gap:8,fontSize:15,fontWeight:600},children:[(0,O.jsx)(s.A,{}),"Analytics"]}),children:(0,O.jsx)("div",{style:{padding:"32px"},children:(0,O.jsx)(W.A,{gutter:[24,24],children:(0,O.jsx)(z.A,{span:24,children:(0,O.jsx)(C.A,{title:(0,O.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},children:[(0,O.jsx)(S.A,{style:{backgroundColor:"#722ed1"},icon:(0,O.jsx)(a.A,{})}),(0,O.jsx)("span",{children:"Completion Analytics"})]}),style:{borderRadius:16},children:(0,O.jsxs)(W.A,{gutter:[24,24],children:[(0,O.jsx)(z.A,{span:8,children:(0,O.jsx)(P.A,{title:"Completion Rate",value:Math.round(((null===pe||void 0===pe?void 0:pe.completedFields)||0)/((null===pe||void 0===pe?void 0:pe.totalFields)||1)*100),suffix:"%",valueStyle:{color:"#3f8600"},prefix:(0,O.jsx)(v.A,{})})}),(0,O.jsx)(z.A,{span:8,children:(0,O.jsx)(P.A,{title:"Fields Remaining",value:((null===pe||void 0===pe?void 0:pe.totalFields)||0)-((null===pe||void 0===pe?void 0:pe.completedFields)||0),valueStyle:{color:"#cf1322"},prefix:(0,O.jsx)(d.A,{})})}),(0,O.jsx)(z.A,{span:8,children:(0,O.jsx)(P.A,{title:"Auto-populated Fields",value:(null===ce||void 0===ce||null===(L=ce.steps)||void 0===L?void 0:L.reduce((e,l)=>{var i,t;return e+((null===(i=l.fields)||void 0===i||null===(t=i.filter(e=>e.cqsAutoPopulated))||void 0===t?void 0:t.length)||0)},0))||0,valueStyle:{color:"#1890ff"},prefix:(0,O.jsx)(h.A,{})})})]})})})})})},"analytics")]})})]})})}}}]);
//# sourceMappingURL=174.0659536f.chunk.js.map