"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[108],{2868:(e,s,r)=>{r.d(s,{aZ:()=>E,lX:()=>m,rb:()=>t,Bq:()=>h,fz:()=>l,cS:()=>o,pZ:()=>d,tS:()=>u,r0:()=>c,EW:()=>i,sB:()=>a,Fv:()=>n});const i={MOBILE_BREAKPOINT:768,TABLET_BREAKPOINT:1024,PAGE_SIZE:10,DEBOUNCE_DELAY:300},n={INITIATED:"INITIATED",IN_PROGRESS:"IN_PROGRESS",PENDING_REVIEW:"PENDING_REVIEW",APPROVED:"APPROVED",REJECTED:"REJECTED",COMPLETED:"COMPLETED"},l={LOW:"LOW",MEDIUM:"MEDIUM",HIGH:"HIGH",URGENT:"URGENT",CRITICAL:"CRITICAL"},t=(n.INITIATED,n.IN_PROGRESS,n.PENDING_REVIEW,n.APPROVED,n.REJECTED,n.COMPLETED,l.LOW,l.MEDIUM,l.HIGH,l.URGENT,l.CRITICAL,{MAX_UPLOAD_SIZE:26214400,BYTES_PER_KB:1024,BYTES_PER_MB:1048576,BYTES_PER_GB:1073741824}),a={JVC_PENDING:"JVC_PENDING",PLANT_PENDING:"PLANT_PENDING",CQS_PENDING:"CQS_PENDING",TECH_PENDING:"TECH_PENDING",DRAFT:"DRAFT",IN_PROGRESS:"IN_PROGRESS",COMPLETED:"COMPLETED"},o={OPEN:"OPEN",RESOLVED:"RESOLVED",CLOSED:"CLOSED"},d={ACTIVE:["OPEN"],INACTIVE:["RESOLVED","CLOSED"]},c={CQS:"CQS",TECH:"TECH",JVC:"JVC",PLANT:"PLANT"},E={INTERVAL:3e4,DEBOUNCE_DELAY:2e3},h={DEFAULT_PAGE_SIZE:10,SMALL_PAGE_SIZE:5,LARGE_PAGE_SIZE:15,SHOW_SIZE_CHANGER:!0,SHOW_QUICK_JUMPER:!0},m={ALL:"all",COMPLETED:"completed",IN_PROGRESS:"in-progress",NOT_STARTED:"not-started"},u={INITIATE:"initiate",PENDING:"pending",COMPLETED:"completed",QUERIES:"queries",HISTORY:"history"}},5991:(e,s,r)=>{r.d(s,{JB:()=>n,bj:()=>t,eC:()=>i,rt:()=>l});const i=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return Array.isArray(e)?e:(console.warn("Data is not an array, using fallback:",{data:e,fallback:s}),s)},n=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(!e)return r;if(!s)return i(e,r);const n=s.split(".");let l=e;for(const i of n){if(!l||"object"!==typeof l||!(i in l))return console.warn(`Key '${i}' not found in response:`,e),r;l=l[i]}return i(l,r)},l=e=>i(e).map(e=>"string"===typeof e?{name:e,id:e}:"object"===typeof e&&null!==e?{name:e.name||e.roleName||e.id||"Unknown Role",id:e.id||e.name||e.roleName||Math.random().toString(36),...e}:{name:"Unknown Role",id:Math.random().toString(36)}),t=e=>e?Array.isArray(e)?{assignedPlants:e,primaryPlant:e.length>0?e[0]:null}:"object"===typeof e?{assignedPlants:i(e.assignedPlants||e.plants),primaryPlant:e.primaryPlant||e.primary||null}:{assignedPlants:[],primaryPlant:null}:{assignedPlants:[],primaryPlant:null}},9108:(e,s,r)=>{r.r(s),r.d(s,{default:()=>T});var i=r(7407),n=r(8818),l=r(3722),t=r(5206),a=r(9073),o=r(6569),d=r(2751),c=r(6051),E=r(1686),h=r(3217),m=r(8918),u=r(3737),A=r(3927),p=r(5043),I=r(6649),P=r(2868),x=r(5991),R=r(579);const{Title:j,Text:S}=A.A,{TabPane:g}=m.A,T=()=>{const[e,s]=(0,p.useState)(!0),[r,A]=(0,p.useState)([]),[T,N]=(0,p.useState)(!1),[C,y]=(0,p.useState)(null),[D,f]=(0,p.useState)([]),[_,L]=(0,p.useState)([]),[O,w]=(0,p.useState)(!1);(0,p.useEffect)(()=>{const e=new AbortController;return G(e.signal),()=>{e.abort()}},[]);const G=async e=>{s(!0);try{const s=await I.default.get("/admin/monitoring/user-roles",{signal:e});if(null===e||void 0===e||!e.aborted){const e=(0,x.eC)(s);A(e)}}catch(r){null!==e&&void 0!==e&&e.aborted||(o.Ay.error("Failed to load user role assignments"),console.error("Error fetching user roles:",r),A([]))}finally{null!==e&&void 0!==e&&e.aborted||s(!1)}},U=[{title:"Username",dataIndex:"username",key:"username",sorter:(e,s)=>e.username.localeCompare(s.username)},{title:"Email",dataIndex:"email",key:"email"},{title:"Assigned Roles",dataIndex:"assignedRoles",key:"assignedRoles",render:e=>(e||[]).map(e=>e.name).join(", ")},{title:"Actions",key:"actions",render:(e,s)=>(0,R.jsx)(t.Ay,{type:"primary",icon:(0,R.jsx)(i.A,{}),onClick:()=>{return y(e=s),f([...(e.assignedRoles||[]).map(e=>({...e,key:e.id.toString()})),...(e.availableRoles||[]).map(e=>({...e,key:e.id.toString()}))]),L((e.assignedRoles||[]).map(e=>e.id.toString())),void N(!0);var e},children:"Edit Roles"})}];return(0,R.jsxs)("div",{children:[(0,R.jsx)(j,{level:2,children:"User Role Management"}),(0,R.jsxs)(m.A,{defaultActiveKey:"1",children:[(0,R.jsx)(g,{tab:(0,R.jsxs)("span",{children:[(0,R.jsx)(l.A,{}),"User Roles"]}),children:(0,R.jsxs)(a.A,{children:[(0,R.jsx)(t.Ay,{type:"primary",onClick:G,style:{marginBottom:16},children:"Refresh User Roles"}),e?(0,R.jsxs)("div",{style:{textAlign:"center",padding:"50px"},children:[(0,R.jsx)(E.A,{size:"large"}),(0,R.jsx)("p",{children:"Loading user role assignments..."})]}):(0,R.jsx)(h.A,{dataSource:r,columns:U,rowKey:"userId",pagination:{pageSize:P.Bq.DEFAULT_PAGE_SIZE}})]})},"1"),(0,R.jsx)(g,{tab:(0,R.jsxs)("span",{children:[(0,R.jsx)(n.A,{}),"Workflow Permissions"]}),children:(0,R.jsx)(a.A,{children:(0,R.jsxs)("div",{style:{padding:"20px"},children:[(0,R.jsx)(j,{level:4,children:"Workflow Role Permissions"}),(0,R.jsxs)(c.A,{direction:"vertical",style:{width:"100%"},children:[(0,R.jsx)(a.A,{title:"JVC User Permissions",size:"small",children:(0,R.jsxs)("ul",{children:[(0,R.jsx)("li",{children:"Initiate MSDS workflows for materials"}),(0,R.jsx)("li",{children:"Assign workflows to plant teams"}),(0,R.jsx)("li",{children:"View JVC dashboard with pending extensions"}),(0,R.jsx)("li",{children:"Respond to queries from plant teams"})]})}),(0,R.jsx)(a.A,{title:"Plant User Permissions",size:"small",children:(0,R.jsxs)("ul",{children:[(0,R.jsx)("li",{children:"Complete multi-step questionnaires"}),(0,R.jsx)("li",{children:"Raise queries to CQS/Tech/JVC teams"}),(0,R.jsx)("li",{children:"View plant dashboard with assigned materials"}),(0,R.jsx)("li",{children:"Mark materials as completed"})]})}),(0,R.jsx)(a.A,{title:"CQS User Permissions",size:"small",children:(0,R.jsxs)("ul",{children:[(0,R.jsx)("li",{children:"Receive and resolve queries from plant teams"}),(0,R.jsx)("li",{children:"View CQS dashboard with pending queries"}),(0,R.jsx)("li",{children:"Access material context for queries"})]})}),(0,R.jsx)(a.A,{title:"Tech User Permissions",size:"small",children:(0,R.jsxs)("ul",{children:[(0,R.jsx)("li",{children:"Receive and resolve technical queries from plant teams"}),(0,R.jsx)("li",{children:"View Tech dashboard with pending queries"}),(0,R.jsx)("li",{children:"Access material context for queries"})]})}),(0,R.jsx)(a.A,{title:"Admin Permissions",size:"small",children:(0,R.jsxs)("ul",{children:[(0,R.jsx)("li",{children:"Access workflow monitoring dashboard"}),(0,R.jsx)("li",{children:"Generate query SLA reports"}),(0,R.jsx)("li",{children:"Manage user roles and permissions"}),(0,R.jsx)("li",{children:"Export audit logs and workflow reports"}),(0,R.jsx)("li",{children:"View all workflows regardless of state"})]})})]}),(0,R.jsx)(S,{type:"secondary",style:{marginTop:16,display:"block"},children:"Note: Users can have multiple roles assigned to them. The permissions are cumulative."})]})})},"2")]}),(0,R.jsx)(d.A,{title:"Edit User Roles",open:T,onOk:async()=>{if(C){w(!0);try{const e=_.map(e=>parseInt(e,10));await I.default.put(`/admin/monitoring/user-roles/${C.userId}`,e),o.Ay.success("User roles updated successfully"),N(!1),G()}catch(e){o.Ay.error("Failed to update user roles"),console.error("Error updating user roles:",e)}finally{w(!1)}}},onCancel:()=>N(!1),width:800,confirmLoading:O,children:C&&(0,R.jsxs)(R.Fragment,{children:[(0,R.jsxs)("p",{children:[(0,R.jsx)("strong",{children:"User:"})," ",C.username," (",C.email,")"]}),(0,R.jsx)("p",{children:"Assign or remove roles using the transfer control below:"}),(0,R.jsx)(u.A,{dataSource:D,titles:["Available Roles","Assigned Roles"],targetKeys:_,onChange:e=>{L(e)},render:e=>e.name,listStyle:{width:350,height:300}})]})})]})}}}]);
//# sourceMappingURL=108.a9b27817.chunk.js.map