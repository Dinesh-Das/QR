spring.application.name=qrmfg

# Server configuration for Tomcat deployment
server.servlet.context-path=/qrmfg
server.port=8080

# Static resource handling
spring.web.resources.static-locations=classpath:/static/
spring.mvc.static-path-pattern=/**

# Oracle Database
spring.datasource.url=jdbc:oracle:thin:@localhost:1521/xe
spring.datasource.username=system
spring.datasource.password=root
spring.datasource.driver-class-name=oracle.jdbc.OracleDriver
spring.jpa.hibernate.ddl-auto=create-drop
spring.jpa.database-platform=org.hibernate.dialect.Oracle12cDialect
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.show-sql=false

# HikariCP Configuration for Oracle
spring.datasource.hikari.auto-commit=false
spring.datasource.hikari.connection-timeout=20000
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.idle-timeout=300000
spring.datasource.hikari.max-lifetime=1200000
spring.datasource.hikari.connection-init-sql=SELECT 1 FROM DUAL

# Hibernate Envers Configuration - Temporarily disabled to fix constraint issues
# spring.jpa.properties.org.hibernate.envers.audit_table_suffix=_aud
# spring.jpa.properties.org.hibernate.envers.revision_field_name=rev
# spring.jpa.properties.org.hibernate.envers.revision_type_field_name=revtype
# spring.jpa.properties.org.hibernate.envers.store_data_at_delete=true


# JWT
jwt.secret=MySecretKeyForJWTTokenGenerationAndValidation2024!@#$%^&*()
jwt.expiration=604800000 

# Email Configuration (Spring Mail)
spring.mail.host=smtp.gmail.com
spring.mail.port=587
spring.mail.username=dinesh.dasdev01@gmail.com
spring.mail.password=mezp uvwh aefo awpa
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.starttls.required=true
spring.mail.properties.mail.smtp.ssl.trust=smtp.gmail.com
spring.mail.properties.mail.smtp.ssl.protocols=TLSv1.2
spring.mail.properties.mail.smtp.connectiontimeout=5000
spring.mail.properties.mail.smtp.timeout=5000
spring.mail.properties.mail.smtp.writetimeout=5000

# Outlook SMTP settings
# spring.mail.host=smtp-mail.outlook.com
# spring.mail.port=587
# spring.mail.username=your-email@outlook.com
# spring.mail.password=your-password
# spring.mail.properties.mail.smtp.auth=true
# spring.mail.properties.mail.smtp.starttls.enable=true
# spring.mail.properties.mail.smtp.ssl.trust=smtp-mail.outlook.com


# Thymeleaf Configuration for Email Templates
spring.thymeleaf.prefix=classpath:/templates/
spring.thymeleaf.suffix=.html
spring.thymeleaf.mode=HTML
spring.thymeleaf.encoding=UTF-8
spring.thymeleaf.cache=false

# Notification Configuration
notification.enabled=true
notification.email.enabled=true
notification.email.from=noreply@qrmfg.com
notification.email.from-name=QRMFG Workflow System
notification.template.base-path=classpath:/templates/notifications/
notification.template.default-engine=thymeleaf
notification.retry.max-attempts=3
notification.retry.delay-millis=5000
notification.retry.backoff-multiplier=2.0

spring.security.user.name=admin
spring.security.user.password=admin

#port config
server.port=8081

# Monitoring and Performance Configuration
management.endpoints.web.exposure.include=health,info,metrics,prometheus,httptrace,loggers
management.endpoint.health.show-details=always
management.endpoint.metrics.enabled=true
management.endpoint.prometheus.enabled=true
management.metrics.export.prometheus.enabled=true
management.metrics.distribution.percentiles-histogram.http.server.requests=true
management.metrics.distribution.percentiles.http.server.requests=0.5,0.95,0.99
management.metrics.tags.application=qrmfg-workflow

# Performance monitoring
performance.monitoring.enabled=true
performance.monitoring.slow-query-threshold-ms=1000
performance.monitoring.slow-workflow-threshold-ms=2000
performance.monitoring.slow-notification-threshold-ms=5000
performance.monitoring.slow-api-threshold-ms=3000

# User activity tracking
user.activity.tracking.enabled=true
user.activity.tracking.retention-days=90
user.activity.tracking.batch-size=100

# Database performance
spring.jpa.properties.hibernate.generate_statistics=false
spring.jpa.properties.hibernate.session.events.log.LOG_QUERIES_SLOWER_THAN_MS=1000
spring.jpa.properties.hibernate.cache.use_second_level_cache=false
spring.jpa.properties.hibernate.cache.use_query_cache=false
spring.jpa.properties.hibernate.cache.region.factory_class=org.hibernate.cache.internal.NoCacheRegionFactory
spring.jpa.properties.hibernate.jdbc.batch_size=25

# Caching configuration
spring.cache.type=simple
spring.cache.cache-names=projects,materials,plants,blocks,questionnaire-templates
spring.cache.caffeine.spec=maximumSize=1000,expireAfterWrite=30m

# Duplicate Hibernate Envers Configuration removed - already defined above

# Duplicate Security Configuration removed - already defined above

# Duplicate JWT Configuration removed - already defined above

# File Upload Configuration
spring.servlet.multipart.max-file-size=25MB
spring.servlet.multipart.max-request-size=100MB
spring.servlet.multipart.location=${java.io.tmpdir}
spring.servlet.multipart.file-size-threshold=1MB

# Document Storage Configuration
app.document.storage.path=./documents
app.document.allowed-types=pdf,docx,xlsx
app.document.max-size=26214400

# Notification Configuration (Mock for Testing)
app.notification.email.enabled=true

# Cache Configuration
spring.cache.type=simple
spring.cache.cache-names=projects,materials,plants,blocks,questionnaires

# Logging Configuration
logging.level.com.cqs.qrmfg=INFO
logging.level.com.cqs.qrmfg.filter.RBACAuthorizationFilter=DEBUG
logging.level.com.cqs.qrmfg.service.RBACAuthorizationService=DEBUG
logging.level.com.cqs.qrmfg.service.SimpleJwtService=DEBUG
logging.level.com.cqs.qrmfg.config.JwtAuthenticationFilter=DEBUG
logging.level.org.springframework.security=WARN
logging.level.org.hibernate.SQL=WARN
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=WARN
logging.level.org.hibernate.engine.internal.StatisticalLoggingSessionEventListener=ERROR
logging.level.org.hibernate.tool.schema.internal.ExceptionHandlerLoggedImpl=ERROR
logging.level.org.hibernate.orm.connections.access=WARN

# Performance Monitoring
management.endpoints.web.exposure.include=health,metrics,info
management.endpoint.health.show-details=always
management.metrics.export.simple.enabled=true

# Async Configuration for Testing
spring.task.execution.pool.core-size=5
spring.task.execution.pool.max-size=10
spring.task.execution.pool.queue-capacity=100

# Transaction Configuration
spring.transaction.default-timeout=30
spring.jpa.properties.hibernate.connection.autocommit=false
spring.jpa.properties.hibernate.connection.provider_disables_autocommit=true
spring.jpa.properties.hibernate.current_session_context_class=org.springframework.orm.hibernate5.SpringSessionContext
spring.jpa.open-in-view=false

# Mock External Services
app.external.email.mock=false
app.external.ldap.mock=true

# Performance Test Thresholds (in milliseconds)
app.test.performance.dashboard.threshold=2000
app.test.performance.dropdown.threshold=500
app.test.performance.query.threshold=1000
app.test.performance.export.threshold=5000
app.test.performance.concurrent.threshold=10000

# Memory Test Configuration
app.test.memory.max-increase=104857600
app.test.memory.gc-recovery-ratio=0.5

# Validation Configuration
app.validation.project-code.pattern=^SER-[A-Z]-\\d{6}$
app.validation.material-code.pattern=^R\\d{5}[A-Z]$
app.validation.plant-code.pattern=^\\d{4}$
app.validation.block-code.pattern=^\\d{4}-[A-Z]$

# SLA Configuration for Testing
app.sla.query-resolution.days=3
app.sla.workflow-completion.days=14
app.sla.notification.retry-attempts=3
app.sla.notification.retry-delay=1000

# Audit Configuration
app.audit.enabled=true
app.audit.retention.days=365
app.audit.export.batch-size=1000

# RBAC Security Configuration
rbac.security.enabled=true
rbac.security.audit-enabled=true
rbac.security.plant-filtering-enabled=true
rbac.security.method-security-enabled=true
rbac.security.default-role=PLANT_USER
rbac.security.strict-role-validation=true
rbac.security.plant-code-validation=true
rbac.security.max-failed-attempts=5
rbac.security.role-hierarchy-enabled=true

# Role-specific session timeouts (in seconds)
rbac.security.role-session-timeouts.ADMIN=28800
rbac.security.role-session-timeouts.TECH_USER=14400
rbac.security.role-session-timeouts.JVC_USER=10800
rbac.security.role-session-timeouts.CQS_USER=10800
rbac.security.role-session-timeouts.PLANT_USER=7200

# Role-specific maximum concurrent sessions
rbac.security.max-concurrent-sessions.ADMIN=5
rbac.security.max-concurrent-sessions.TECH_USER=3
rbac.security.max-concurrent-sessions.JVC_USER=2
rbac.security.max-concurrent-sessions.CQS_USER=2
rbac.security.max-concurrent-sessions.PLANT_USER=1

# URL patterns that bypass RBAC validation
rbac.security.bypass-patterns[0]=/qrmfg/api/v1/auth/**
rbac.security.bypass-patterns[1]=/qrmfg/api/v1/public/**
rbac.security.bypass-patterns[2]=/static/**
rbac.security.bypass-patterns[3]=/css/**
rbac.security.bypass-patterns[4]=/js/**
rbac.security.bypass-patterns[5]=/*.html
rbac.security.bypass-patterns[6]=/*.ico
rbac.security.bypass-patterns[7]=/*.png
rbac.security.bypass-patterns[8]=/*.jpg
rbac.security.bypass-patterns[9]=/*.gif

# Role-specific URL patterns
rbac.security.role-url-patterns.ADMIN[0]=/**
rbac.security.role-url-patterns.JVC_USER[0]=/qrmfg/api/v1/jvc/**
rbac.security.role-url-patterns.JVC_USER[1]=/qrmfg/api/v1/workflows/**
rbac.security.role-url-patterns.JVC_USER[2]=/qrmfg/api/v1/queries/**
rbac.security.role-url-patterns.JVC_USER[3]=/qrmfg/api/v1/projects/**
rbac.security.role-url-patterns.CQS_USER[0]=/qrmfg/api/v1/cqs/**
rbac.security.role-url-patterns.CQS_USER[1]=/qrmfg/api/v1/quality/**
rbac.security.role-url-patterns.CQS_USER[2]=/qrmfg/api/v1/workflows/**
rbac.security.role-url-patterns.CQS_USER[3]=/qrmfg/api/v1/queries/**
rbac.security.role-url-patterns.TECH_USER[0]=/qrmfg/api/v1/tech/**
rbac.security.role-url-patterns.TECH_USER[1]=/qrmfg/api/v1/admin/users/**
rbac.security.role-url-patterns.TECH_USER[2]=/qrmfg/api/v1/admin/audit/**
rbac.security.role-url-patterns.TECH_USER[3]=/qrmfg/api/v1/queries/**
rbac.security.role-url-patterns.PLANT_USER[0]=/qrmfg/api/v1/plant/**
rbac.security.role-url-patterns.PLANT_USER[1]=/qrmfg/api/v1/operations/**
rbac.security.role-url-patterns.PLANT_USER[2]=/qrmfg/api/v1/workflows/**

# RBAC Audit Configuration
rbac.audit.enabled=true
rbac.audit.log-successful-access=false
rbac.audit.log-failed-access=true
rbac.audit.log-screen-access=true
rbac.audit.log-data-access=true
rbac.audit.log-plant-access=true
rbac.audit.retention-days=90
rbac.audit.batch-size=100

# Plant Access Configuration
rbac.plant.max-plants-per-user=20
rbac.plant.default-plant=MAIN
rbac.plant.validation-enabled=true
rbac.plant.auto-assign-primary=true

# RBAC Performance Configuration
rbac.performance.cache-enabled=true
rbac.performance.cache-ttl-seconds=3600
rbac.performance.role-cache-size=1000
rbac.performance.plant-cache-size=5000
rbac.performance.screen-cache-size=2000

# Error Handling Configuration
server.error.whitelabel.enabled=false
server.error.include-message=always
server.error.include-binding-errors=always
server.error.include-stacktrace=on_param
server.error.include-exception=false

# SPA Configuration
spring.web.resources.add-mappings=true
spring.web.resources.static-locations=classpath:/static/
spring.web.resources.cache.cachecontrol.max-age=31536000

# Server Configuration
server.compression.enabled=true
server.compression.mime-types=text/html,text/xml,text/plain,text/css,text/javascript,application/javascript,application/json
server.compression.min-response-size=1024

# Default Notification Preferences Configuration
# Admin can configure which notifications are enabled by default for new users

# General default preferences (applied to all users unless role-specific overrides exist)
app.notifications.defaults.preferences.WORKFLOW_CREATED=true
app.notifications.defaults.preferences.WORKFLOW_COMPLETED=true
app.notifications.defaults.preferences.WORKFLOW_STATE_CHANGED=false
app.notifications.defaults.preferences.WORKFLOW_OVERDUE=true
app.notifications.defaults.preferences.QUERY_RAISED=true
app.notifications.defaults.preferences.QUERY_RESOLVED=true
app.notifications.defaults.preferences.QUERY_ASSIGNED=true
app.notifications.defaults.preferences.QUERY_OVERDUE=true

# Role-based default preferences (CQS users)
app.notifications.defaults.role-based-preferences.CQS.WORKFLOW_CREATED=true
app.notifications.defaults.role-based-preferences.CQS.WORKFLOW_COMPLETED=true
app.notifications.defaults.role-based-preferences.CQS.WORKFLOW_STATE_CHANGED=true
app.notifications.defaults.role-based-preferences.CQS.WORKFLOW_OVERDUE=true
app.notifications.defaults.role-based-preferences.CQS.QUERY_RAISED=true
app.notifications.defaults.role-based-preferences.CQS.QUERY_RESOLVED=true
app.notifications.defaults.role-based-preferences.CQS.QUERY_ASSIGNED=true
app.notifications.defaults.role-based-preferences.CQS.QUERY_OVERDUE=true

# Role-based default preferences (JVC users)
app.notifications.defaults.role-based-preferences.JVC.WORKFLOW_CREATED=false
app.notifications.defaults.role-based-preferences.JVC.WORKFLOW_COMPLETED=true
app.notifications.defaults.role-based-preferences.JVC.WORKFLOW_STATE_CHANGED=false
app.notifications.defaults.role-based-preferences.JVC.WORKFLOW_OVERDUE=true
app.notifications.defaults.role-based-preferences.JVC.QUERY_RAISED=false
app.notifications.defaults.role-based-preferences.JVC.QUERY_RESOLVED=false
app.notifications.defaults.role-based-preferences.JVC.QUERY_ASSIGNED=false
app.notifications.defaults.role-based-preferences.JVC.QUERY_OVERDUE=false

# Role-based default preferences (PLANT users)
app.notifications.defaults.role-based-preferences.PLANT.WORKFLOW_CREATED=false
app.notifications.defaults.role-based-preferences.PLANT.WORKFLOW_COMPLETED=false
app.notifications.defaults.role-based-preferences.PLANT.WORKFLOW_STATE_CHANGED=true
app.notifications.defaults.role-based-preferences.PLANT.WORKFLOW_OVERDUE=false
app.notifications.defaults.role-based-preferences.PLANT.QUERY_RAISED=false
app.notifications.defaults.role-based-preferences.PLANT.QUERY_RESOLVED=true
app.notifications.defaults.role-based-preferences.PLANT.QUERY_ASSIGNED=false
app.notifications.defaults.role-based-preferences.PLANT.QUERY_OVERDUE=false

# Role-based default preferences (TECH users)
app.notifications.defaults.role-based-preferences.TECH.WORKFLOW_CREATED=false
app.notifications.defaults.role-based-preferences.TECH.WORKFLOW_COMPLETED=false
app.notifications.defaults.role-based-preferences.TECH.WORKFLOW_STATE_CHANGED=false
app.notifications.defaults.role-based-preferences.TECH.WORKFLOW_OVERDUE=false
app.notifications.defaults.role-based-preferences.TECH.QUERY_RAISED=true
app.notifications.defaults.role-based-preferences.TECH.QUERY_RESOLVED=false
app.notifications.defaults.role-based-preferences.TECH.QUERY_ASSIGNED=true
app.notifications.defaults.role-based-preferences.TECH.QUERY_OVERDUE=true

# QR Analytics Configuration
qr.analytics.cache.enabled=true
qr.analytics.cache.ttl=300
qr.analytics.export.max-records=10000
qr.analytics.export.timeout=30000

# QR Analytics Logging
logging.level.com.cqs.qrmfg.service.QRAnalyticsService=INFO
logging.level.com.cqs.qrmfg.controller.QRAnalyticsController=INFO